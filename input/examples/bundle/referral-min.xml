<?xml version="1.0" encoding="UTF-8"?>

<Bundle xmlns="http://hl7.org/fhir">
  <id value="referral-min" />
  <meta>
    <versionId value="1" />
    <lastUpdated value="2019-04-01T20:18:41.341+00:00" />
    <profile value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-document" />
  </meta>
  <identifier>
    <system value="http://test.fhir.ch/id/uuid" />
    <value value="26d3dff7-ab05-4737-a49c-5eccd33595f8" />
  </identifier>
  <type value="document" />
  <timestamp value="2019-04-01T20:18:41.341+00:00" />

  <!-- #0 entry Composition-->
  <entry>
    <fullUrl value="http://test.fhir.ch/r4/Composition/referral-min" />
    <resource>
      <Composition xmlns="http://hl7.org/fhir">
        <id value="referral-min" />
        <meta>
          <profile value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-composition" />
        </meta>
        <text>
          <status value="generated" />
          <div xmlns="http://www.w3.org/1999/xhtml">
            Referral min (Template)
            </div>
        </text>

        <extension url="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-visitnumber">
          <valueIdentifier>
            <value value="123" />
          </valueIdentifier>
        </extension>

        <identifier>
          <system value="http://test.fhir.ch/id/uuid" />
          <value value="26d3dff7-ab05-4737-a49c-5eccd33595f7" />
        </identifier>
        <status value="final" />

        <type>
          <coding>
            <system value="http://snomed.info/sct" />
            <code value="721965002" />
            <display value="Laboratory order (record artifact)" />
          </coding>
        </type>

        <category>
          <coding>
            <system value="http://snomed.info/sct" />
            <code value="721963009" />
            <display value="Order (record artifact)" />
          </coding>
        </category>

        <subject>
          <reference value="Patient/FranzMuster" />
        </subject>
        <date value="2019-03-31T11:46:09+02:00" />

        <author>
          <reference value="Practitioner/MarcMustermann" />
        </author>
        <title value="Referral min" />

        <attester>
          <mode value="professional" />
          <time value="2010-03-12T11:46:09+02:00" />
          <party>
            <reference value="Practitioner/MarcMustermann" />
          </party>
        </attester>

        <!-- sections -->
        <section>
          <title value="Referral" />
          <text>
            <status value="generated" />
            <div xmlns="http://www.w3.org/1999/xhtml">
              Referral min
            </div>
          </text>
          <entry>
            <reference value="Questionnaire/referral-min" />
          </entry>
          <entry>
            <reference value="QuestionnaireResponse/referral-min" />
          </entry>
          <entry>
            <reference value="ServiceRequest/referral-min" />
          </entry>
        </section>
      </Composition>
    </resource>
  </entry>

  <!-- entry[1] ch-core-Patient -->
  <entry>
    <fullUrl value="http://test.fhir.ch/r4/Patient/FranzMuster" />
    <resource>
      <Patient xmlns="http://hl7.org/fhir">
        <id value="FranzMuster" />
        <meta>
          <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient" />
        </meta>
        <name>
          <family value="Muster" />
          <given value="Franz" />
        </name>
        <birthDate value="1970-03-14" />
      </Patient>
    </resource>
  </entry>

  <!--  entry[2] practitioner -->
  <entry>
    <fullUrl value="http://test.fhir.ch/r4/Practitioner/MarcMustermann" />
    <resource>
      <Practitioner xmlns="http://hl7.org/fhir">
        <id value="MarcMustermann" />
        <meta>
          <profile value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-practitioner" />
        </meta>
        <name>
          <family value="Mustermann" />
          <given value="Marc" />
        </name>
      </Practitioner>
    </resource>
  </entry>

  <!-- entry[3] questionnaire -->
  <entry>
    <fullUrl value="http://test.fhir.ch/r4/Questionnaire/referral-min" />
    <resource>
      <Questionnaire xmlns="http://hl7.org/fhir">
        <id value="referral-min" />
        <text>
          <status value="additional" />
          <div xmlns="http://www.w3.org/1999/xhtml">
            <pre>radio button für geschlecht horizontal, required Element, textbox für untersuchung, Checkboxen mit optional Textangaben, Angabe von mehreren Beilagen</pre>
          </div>
        </text>
        <extension url="http://hl7.org/fhir/uv/sdc/StructureDefinition/sdc-questionnaire-targetStructureMap">
          <valueCanonical value="http://fhir.ch/ig/ch-orf/StructureMap/map-orf" />
        </extension>
        <url value="http://fhir.ch/ig/ch-orf/Questionnaire/referral-min" />
        <name value="ORFReferralMinimial" />
        <title value="ORF Referral Minimial" />
        <status value="draft" />
        <experimental value="true" />
        <subjectType value="Patient" />
        <date value="2020-12-17" />
        <publisher value="eHealth Suisse" />

        <item>
          <linkId value="order" />
          <text value="Auftrag" />
          <type value="group" />
          <item>
            <linkId value="order.number" />
            <text value="Auftrags-Nummer" />
            <type value="string" />
            <required value="true" />
          </item>
        </item>

        <item>
          <linkId value="patient" />
          <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient" />
          <text value="Patient" />
          <type value="group" />
          <item>
            <linkId value="patient.familyname" />
            <!-- don't know how to go deeper (Patient name coud repeat and HumanName is a type should reference something like #Patient.name[use="offical"].family -->
            <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient#Patient.name" />
            <code>
              <system value="http://fhir.ch/ig/ch-orf/CodeSystem/minimaldataset" />
              <code value="Patient.name.family" />
            </code>
            <text value="Name" />
            <type value="string" />
            <required value="true" />
          </item>
          <item>
            <linkId value="patient.givenname" />
            <definition value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-core-patient#Patient.name" />
            <code>
              <system value="http://fhir.ch/ig/ch-orf/CodeSystem/minimaldataset" />
              <code value="Patient.name.given" />
            </code>
            <text value="Vorname" />
            <type value="string" />
            <required value="true" />
          </item>
          <item>
            <linkId value="patient.birthdate" />
            <text value="Geburtsdatum" />
            <type value="date" />
            <required value="true" />
          </item>
        </item>

        <item>
          <linkId value="orderer" />
          <text value="Auftraggeber" />
          <type value="group" />
          <item>
            <linkId value="orderer.author" />
            <text value="Verantwortlicher" />
            <type value="group" />
            <item>
              <linkId value="orderer.author.organization" />
              <text value="Organisation" />
              <type value="string" />
            </item>
            <item>
              <linkId value="orderer.author.familyname" />
              <text value="Name" />
              <type value="string" />
            </item>
            <item>
              <linkId value="orderer.author.givenname" />
              <text value="Vorname" />
              <type value="string" />
            </item>
          </item>
        </item>
      </Questionnaire>
    </resource>
  </entry>

  <!-- entry[4] questionnaireresponse -->
  <entry>
    <fullUrl value="http://test.fhir.ch/r4/QuestionnaireResponse/referral-min" />
    <resource>
      <QuestionnaireResponse xmlns="http://hl7.org/fhir">
        <id value="referral-min" />
        <meta>
          <profile value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-questionnaireresponse" />
        </meta>
        <questionnaire value="http://fhir.ch/ig/ch-orf/Questionnaire/referral-min" />
        <status value="completed" />
        <item>
          <linkId value="order" />
          <text value="Auftrag" />
          <item>
            <linkId value="order.number" />
            <text value="Auftrags-Nummer" />
            <answer>
              <valueString value="123" />
            </answer>
          </item>
        </item>
        <item>
          <linkId value="patient" />
          <text value="Patient" />
          <item>
            <linkId value="patient.familyname" />
            <text value="Name" />
            <answer>
              <valueString value="Muster" />
            </answer>
          </item>
          <item>
            <linkId value="patient.givenname" />
            <text value="Vorname" />
            <answer>
              <valueString value="Franz" />
            </answer>
          </item>
          <item>
            <linkId value="patient.birthdate" />
            <text value="Geburtsdatum" />
            <answer>
              <valueDate value="1995-01-27" />
            </answer>
          </item>
        </item>
        <item>
          <linkId value="orderer" />
          <text value="Auftraggeber" />
          <item>
            <linkId value="orderer.author" />
            <text value="Verantwortlicher" />
            <item>
              <linkId value="orderer.author.organization" />
              <text value="Organisation" />
              <answer>
                <valueString value="RegionalspitalZugersee" />
              </answer>
            </item>
            <item>
              <linkId value="orderer.author.familyname" />
              <text value="Name" />
              <answer>
                <valueString value="Mustermann" />
              </answer>
            </item>
            <item>
              <linkId value="orderer.author.givenname" />
              <text value="Vorname" />
              <answer>
                <valueString value="Marc" />
              </answer>
            </item>
          </item>
        </item>
      </QuestionnaireResponse>
    </resource>
  </entry>

  <!-- entry[5] serviceRequest -->
  <entry>
    <fullUrl value="http://test.fhir.ch/r4/ServiceRequest/referral-min" />
    <resource>
      <ServiceRequest xmlns="http://hl7.org/fhir">
        <id value="referral-min" />
        <status value="active" />
        <intent value="original-order" />
        <subject>
          <reference value="Patient/FranzMuster" />
        </subject>
        <requester>
          <reference value="Practitioner/MarcMustermann" />
        </requester>
      </ServiceRequest>
    </resource>
  </entry>

</Bundle>