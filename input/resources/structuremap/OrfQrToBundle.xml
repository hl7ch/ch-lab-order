<StructureMap 
  xmlns="http://hl7.org/fhir">
  <id value="OrfQrToBundle"></id>
  <text>
    <status value="generated"></status>
    <div 
      xmlns="http://www.w3.org/1999/xhtml">
      <pre>map "http://fhir.ch/ig/ch-orf/StructureMap/OrfQrToBundle" = "OrfQrToBundle"

// ORF Questionnaire Response to Bundle
// 2021-01-11 Oliver Egger, copyright ahdis ag, Apache License
// QRF Questionnaire: http://build.fhir.org/ig/ehealthsuisse/ch-orf/Questionnaire-referral-min.html
// QRF Questionnaire Response: http://build.fhir.org/ig/ehealthsuisse/ch-orf/QuestionnaireResponse-referral-min.xml.html
// Bundle: http://build.fhir.org/ig/ehealthsuisse/ch-orf/StructureDefinition-ch-orf-document.html

uses "http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse" alias QuestionnaireResponse as source
uses "http://hl7.org/fhir/StructureDefinition/Bundle" alias Bundle as target
uses "http://hl7.org/fhir/StructureDefinition/Patient" alias Patient as target
uses "http://hl7.org/fhir/StructureDefinition/Organization" alias Organization as target
uses "http://hl7.org/fhir/StructureDefinition/Practitioner" alias Practitioner as target
uses "http://hl7.org/fhir/StructureDefinition/PractitionerRole" alias PractitionerRole as target
uses "http://hl7.org/fhir/StructureDefinition/ServiceRequest" alias ServiceRequest as target
uses "http://hl7.org/fhir/StructureDefinition/BackboneElement" alias BackboneElement as target

group OrfQrToBundle(source qr : QuestionnaireResponse, target bundle : Bundle) {
  qr -&gt;  bundle.identifier as documentIdentifier,  documentIdentifier.system = 'urn:ietf:rfc:3986',  uuid() as uuidDoc,  documentIdentifier.value = append('urn:uuid:', uuidDoc) "documentIdentifier";
  qr -&gt; bundle.timestamp = (now()) "assembling time";
  qr as qrcp -&gt;  bundle.entry as e,  e.resource = create('Composition') as composition,  composition.id = uuid() as uuid,  e.fullUrl = append('urn:uuid:', uuid),  bundle.entry as e2,  e2.resource = create('Patient') as patient,  patient.id = uuid() as uuid2,  e2.fullUrl = append('urn:uuid:', uuid2),  bundle.entry as e4,  e4.resource = qrcp as questionnaireresp,  questionnaireresp.id = uuid() as uuid4,  e4.fullUrl = append('urn:uuid:', uuid4),  bundle.entry as e5,  e5.resource = create('ServiceRequest') as servicerequest,  servicerequest.id = uuid() as uuid5,  e5.fullUrl = append('urn:uuid:', uuid5) then {
    qr then QrToBundle(qr, patient, questionnaireresp, servicerequest, composition, bundle) "orfbundle";
  } "orfbundle";
}

group QrToGroups(source qr : QuestionnaireResponse, target patient : Patient, target bundle : Bundle, target composition : Composition, target serviceRequest : ServiceRequest) {
  qr.item as grp where linkId = 'order' then OrderItems(grp, bundle, composition, serviceRequest) "grporder";
  qr.item as grp where linkId = 'receiverRequest' then ReceiverRequestInit(grp, bundle, composition, serviceRequest) "receiverRequest";
  qr.item as grp where linkId = 'patient' then PatientItems(grp, patient) "grppatient";
  qr.item as grp where linkId = 'orderer' then OrdererAuthorInit(grp, bundle, composition, serviceRequest) "grporderer";
  qr.item as grp where linkId = 'receiverResponses' then ReceiverResponse(grp, bundle, composition, serviceRequest) "grporderer";
}

group OrderItems(source src : BackboneElement, target bundle : Bundle, target composition, target serviceRequest : ServiceRequest) {
  src.item as item where ((linkId.value = 'order.precedentDocumentIdentifier') and answer.exists()) -&gt;  composition.extension as ext,  ext.url = 'http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-precedentdocument',  ext.value = create('Identifier') as value,  value.value = (item.answer.valueString) "precedentDocumentIdentifier";
  src.item as item where ((linkId.value = 'order.placerOrderIdentifier') and answer.exists()) -&gt;  serviceRequest.identifier as value share placer,  value.type as type,  type.coding as coding,  coding.system = 'http://terminology.hl7.org/CodeSystem/v2-0203',  coding.code = 'PLAC',  value.value = (item.answer.valueString) "placerOrderIdentifier";
  src.item as item where ((linkId.value = 'order.placerOrderIdentifierDomain') and answer.exists()) -&gt;  serviceRequest.identifier as value share placer,  value.system = (item.answer.valueString) "placerOrderIdentifierDomain";
  src.item as item where ((linkId.value = 'order.fillerOrderIdentifier') and answer.exists()) -&gt;  serviceRequest.identifier as value share filler,  value.type as type,  type.coding as coding,  coding.system = 'http://terminology.hl7.org/CodeSystem/v2-0203',  coding.code = 'FILL',  value.value = (item.answer.valueString) "fillerOrderIdentifier";
  src.item as item where ((linkId.value = 'order.fillerOrderIdentifierDomain') and answer.exists()) -&gt;  serviceRequest.identifier as value share filler,  value.system = (item.answer.valueString) "fillerOrderIdentifierDomain";
  src.item as item where ((linkId.value = 'order.dateTime') and answer.exists()) -&gt; serviceRequest.authoredOn = (item.answer.value);
  src.item as item where ((linkId.value = 'order.priority') and answer.exists()) -&gt; serviceRequest.priority = (item.answer.value.code);
  src.item as item where (linkId.value = 'order.notificationContactDocument') then {
    item -&gt;  bundle.entry as e4,  e4.resource = create('PractitionerRole') as practitionerRoleDataEnterer,  practitionerRoleDataEnterer.id = uuid() as uuid4,  e4.fullUrl = append('urn:uuid:', uuid4),  composition.extension as extension,  bundle.entry as e5,  e5.resource = create('Practitioner') as practitionerDataEnterer,  practitionerDataEnterer.id = uuid() as uuid5,  e5.fullUrl = append('urn:uuid:', uuid5),  practitionerRoleDataEnterer.practitioner = create('Reference') as reference,  reference.type = 'Practitioner',  reference.reference = append('urn:uuid:', uuid5) then {
      item then UrgentNotificationContactForRequestItems(item, practitionerRoleDataEnterer, practitionerDataEnterer) "data";
      item then ExtOrfUrgentNotificationContactForRequest(item, practitionerRoleDataEnterer, extension) "extension";
    } "items";
  } "notificationContactDocument";
  src.item as item where (linkId.value = 'order.notificationContactDocumentResponse') then {
    item -&gt;  bundle.entry as e4,  e4.resource = create('PractitionerRole') as practitionerRoleDataEnterer,  practitionerRoleDataEnterer.id = uuid() as uuid4,  e4.fullUrl = append('urn:uuid:', uuid4),  composition.extension as extension,  bundle.entry as e5,  e5.resource = create('Practitioner') as practitionerDataEnterer,  practitionerDataEnterer.id = uuid() as uuid5,  e5.fullUrl = append('urn:uuid:', uuid5),  practitionerRoleDataEnterer.practitioner = create('Reference') as reference,  reference.type = 'Practitioner',  reference.reference = append('urn:uuid:', uuid5) then {
      item then UrgentNotificationContactForResponseItems(item, practitionerRoleDataEnterer, practitionerDataEnterer) "data";
      item then ExtOrfUrgentNotificationContactForResponse(item, practitionerRoleDataEnterer, extension) "extension";
    } "items";
  } "notificationContactDocumentResponse";
}

group UrgentNotificationContactForRequestPractitionerItems(source src : BackboneElement, target practitioner : Practitioner) {
  src.item as item where ((linkId.value = 'order.notificationContactDocument.practitioner.familyName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'order.notificationContactDocument.practitioner.givenName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'order.notificationContactDocument.practitioner.title') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.prefix = (item.answer.value) as prefix,  prefix.extension as ext,  ext.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',  ext.value = create('code') as value,  value.value = 'AC' "title";
  src.item as item where ((linkId.value = 'order.notificationContactDocument.practitioner.phone') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'order.notificationContactDocument.practitioner.email') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
}

group UrgentNotificationContactForRequestItems(source src : BackboneElement, target practitionerRole : practitionerRole, target practitioner : Practitioner) {
  src.item as item where (linkId.value = 'order.notificationContactDocument.practitioner') then UrgentNotificationContactForRequestPractitionerItems(item, practitioner);
}

group ExtOrfUrgentNotificationContactForRequest(source src : BackboneElement, target practitionerRole : PractitionerRole, target ext : Extension) {
  src -&gt; ext.url = 'http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-urgentnoficationcontactforthisdocument' "url";
  src -&gt;  ext.value = create('Reference') as reference,  reference.type = 'PractitionerRole',  reference.reference = ('urn:uuid:' + %practitionerRole.id) "practitionerRole";
}

group UrgentNotificationContactForResponsePractitionerItems(source src : BackboneElement, target practitioner : Practitioner) {
  src.item as item where ((linkId.value = 'order.notificationContactDocumentResponse.practitioner.familyName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'order.notificationContactDocumentResponse.practitioner.givenName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'order.notificationContactDocumentResponse.practitioner.title') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.prefix = (item.answer.value) as prefix,  prefix.extension as ext,  ext.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',  ext.value = create('code') as value,  value.value = 'AC' "title";
  src.item as item where ((linkId.value = 'order.notificationContactDocumentResponse.practitioner.phone') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'order.notificationContactDocumentResponse.practitioner.email') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
}

group UrgentNotificationContactForResponseItems(source src : BackboneElement, target practitionerRole : practitionerRole, target practitioner : Practitioner) {
  src.item as item where (linkId.value = 'order.notificationContactDocumentResponse.practitioner') then UrgentNotificationContactForResponsePractitionerItems(item, practitioner);
}

group ExtOrfUrgentNotificationContactForResponse(source src : BackboneElement, target practitionerRole : PractitionerRole, target ext : Extension) {
  src -&gt; ext.url = 'http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-urgentnoficationcontactfortheresponsetothisdocument' "url";
  src -&gt;  ext.value = create('Reference') as reference,  reference.type = 'PractitionerRole',  reference.reference = ('urn:uuid:' + %practitionerRole.id) "practitionerRole";
}

group ReceiverRequestPractitionerItems(source src : BackboneElement, target practitioner : Practitioner) {
  src.item as item where ((linkId.value = 'receiverRequest.practitioner.familyName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverRequest.practitioner.givenName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverRequest.practitioner.title') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.prefix = (item.answer.value) as prefix,  prefix.extension as ext,  ext.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',  ext.value = create('code') as value,  value.value = 'AC' "title";
  src.item as item where ((linkId.value = 'receiverRequest.practitioner.gln') and answer.exists()) -&gt;  practitioner.identifier as value,  value.system = 'urn:oid:2.51.1.3',  value.value = (item.answer.value) "gln";
  src.item as item where ((linkId.value = 'receiverRequest.practitioner.phone') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'receiverRequest.practitioner.email') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
}

group ReceiverRequestOrganizationItems(source src : BackboneElement, target organization : Organization) {
  src.item as item where ((linkId.value = 'receiverRequest.organization.name') and answer.exists()) -&gt; organization.name = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverRequest.organization.streetAddressLine') and answer.exists()) -&gt; organization.address as address share orgAddress then {
    item.answer as answer -&gt; address.line = (answer.value) "streetAddressLine";
  } "answer";
  src.item as item where ((linkId.value = 'receiverRequest.organization.postalCode') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.postalCode = (item.answer.value) "postalCode";
  src.item as item where ((linkId.value = 'receiverRequest.organization.city') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.city = (item.answer.value) "city";
  src.item as item where ((linkId.value = 'receiverRequest.organization.country') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.country = (item.answer.value) "country";
}

group ReceiverRequestItems(source src : BackboneElement, target practitionerRole : practitionerRole, target practitioner : Practitioner, target organization : Organization) {
  src.item as item where (linkId.value = 'receiverRequest.practitioner') then ReceiverRequestPractitionerItems(item, practitioner);
  src.item as item where (linkId.value = 'receiverRequest.organization') then ReceiverRequestOrganizationItems(item, organization);
}

group ReceiverRequestInit(source src : BackboneElement, target bundle : Bundle, target composition : Composition, target serviceRequest : ServiceRequest) {
  src -&gt;  bundle.entry as e,  e.resource = create('PractitionerRole') as practitionerRole,  practitionerRole.id = uuid() as uuid,  e.fullUrl = append('urn:uuid:', uuid),  bundle.entry as e2,  e2.resource = create('Practitioner') as practitioner,  practitioner.id = uuid() as uuid2,  e2.fullUrl = append('urn:uuid:', uuid2),  bundle.entry as e3,  e3.resource = create('Organization') as organization,  organization.id = uuid() as uuid3,  e3.fullUrl = append('urn:uuid:', uuid3),  serviceRequest.performer = create('Reference') as reference,  reference.type = 'PractitionerRole',  reference.reference = append('urn:uuid:', uuid),  practitionerRole.practitioner = create('Reference') as reference,  reference.type = 'Practitioner',  reference.reference = append('urn:uuid:', uuid2),  practitionerRole.organization = create('Reference') as reference,  reference.type = 'Organization',  reference.reference = append('urn:uuid:', uuid3) then ReceiverRequestItems(src, practitionerRole, practitioner, organization) "receiverRequest";
}

group PatientItems(source src : BackboneElement, target tgt : Patient) {
  src.item as item then PatientItems(item, tgt);
  src.item as item where ((linkId.value = 'patient.familyName') and answer.exists()) -&gt;  tgt.name as name share patientName,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'patient.givenName') and answer.exists()) -&gt;  tgt.name as name share patientName,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'patient.localPid') and answer.exists()) -&gt;  tgt.identifier as value,  value.type as type,  type.coding as coding,  coding.system = 'http://terminology.hl7.org/CodeSystem/v2-0203',  coding.code = 'MR',  value.value = (item.answer.valueString) "localPid";
  src.item as item where ((linkId.value = 'patient.birthDate') and answer.exists()) -&gt; tgt.birthDate = (item.answer.value);
  src.item as item where ((linkId.value = 'patient.gender') and answer.exists()) -&gt; tgt.gender = (item.answer.value.code);
  src.item as item where ((linkId.value = 'patient.phone') and answer.exists()) -&gt;  tgt.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'patient.email') and answer.exists()) -&gt;  tgt.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
  src.item as item where ((linkId.value = 'patient.streetAddressLine') and answer.exists()) -&gt; tgt.address as address share orgAddress then {
    item.answer as answer -&gt; address.line = (answer.value) "streetAddressLine";
  } "answer";
  src.item as item where ((linkId.value = 'patient.postalCode') and answer.exists()) -&gt;  tgt.address as address share orgAddress,  address.postalCode = (item.answer.value) "postalCode";
  src.item as item where ((linkId.value = 'patient.city') and answer.exists()) -&gt;  tgt.address as address share orgAddress,  address.city = (item.answer.value) "city";
  src.item as item where ((linkId.value = 'patient.country') and answer.exists()) -&gt;  tgt.address as address share orgAddress,  address.country = (item.answer.value) "country";
}

group OrdererAuthorPractitionerItems(source src : BackboneElement, target practitioner : Practitioner) {
  src.item as item where ((linkId.value = 'orderer.author.practitioner.familyName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'orderer.author.practitioner.givenName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'orderer.author.practitioner.title') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.prefix = (item.answer.value) as prefix,  prefix.extension as ext,  ext.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',  ext.value = create('code') as value,  value.value = 'AC' "title";
  src.item as item where ((linkId.value = 'orderer.author.practitioner.gln') and answer.exists()) -&gt;  practitioner.identifier as value,  value.system = 'urn:oid:2.51.1.3',  value.value = (item.answer.value) "gln";
  src.item as item where ((linkId.value = 'orderer.author.practitioner.phone') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'orderer.author.practitioner.email') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
}

group OrdererAuthorOrganizationItems(source src : BackboneElement, target organization : Organization) {
  src.item as item where ((linkId.value = 'orderer.author.organization.name') and answer.exists()) -&gt; organization.name = (item.answer.value);
  src.item as item where ((linkId.value = 'orderer.author.organization.streetAddressLine') and answer.exists()) -&gt; organization.address as address share orgAddress then {
    item.answer as answer -&gt; address.line = (answer.value) "streetAddressLine";
  } "answer";
  src.item as item where ((linkId.value = 'orderer.author.organization.postalCode') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.postalCode = (item.answer.value) "postalCode";
  src.item as item where ((linkId.value = 'orderer.author.organization.city') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.city = (item.answer.value) "city";
  src.item as item where ((linkId.value = 'orderer.author.organization.country') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.country = (item.answer.value) "country";
}

group OrdererAuthorItems(source src : BackboneElement, target practitionerRole : practitionerRole, target practitioner : Practitioner, target organization : Organization) {
  src.item as item where (linkId.value = 'orderer.author.practitioner') then OrdererAuthorPractitionerItems(item, practitioner);
  src.item as item where (linkId.value = 'orderer.author.organization') then OrdererAuthorOrganizationItems(item, organization);
}

group OrdererDataEntererPractitionerItems(source src : BackboneElement, target practitioner : Practitioner) {
  src.item as item where ((linkId.value = 'orderer.dataenterer.practitioner.familyName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'orderer.dataenterer.practitioner.givenName') and answer.exists()) -&gt;  practitioner.name as name share practitionerName,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'orderer.dataenterer.practitioner.phone') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'orderer.dataenterer.practitioner.email') and answer.exists()) -&gt;  practitioner.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
}

group OrdererDataEntererItems(source src : BackboneElement, target practitionerRole : practitionerRole, target practitioner : Practitioner, target organization : Organization) {
  src.item as item where (linkId.value = 'orderer.dataenterer.practitioner') then OrdererDataEntererPractitionerItems(item, practitioner);
}

group ChExtEprDataEnterer(source src : BackboneElement, target practitionerRole : PractitionerRole, target ext : Extension) {
  src -&gt; ext.url = 'http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-epr-dataenterer' "url";
  src -&gt;  ext.extension as ext,  ext.url = 'enterer',  ext.value = create('Reference') as reference,  reference.type = 'PractitionerRole',  reference.reference = ('urn:uuid:' + %practitionerRole.id) "practitionerRole";
}

group OrdererAuthorInit(source src : BackboneElement, target bundle : Bundle, target composition : Composition, target serviceRequest : ServiceRequest) {
  src -&gt;  bundle.entry as e,  e.resource = create('PractitionerRole') as practitionerRole,  practitionerRole.id = uuid() as uuid,  e.fullUrl = append('urn:uuid:', uuid),  bundle.entry as e2,  e2.resource = create('Practitioner') as practitioner,  practitioner.id = uuid() as uuid2,  e2.fullUrl = append('urn:uuid:', uuid2),  bundle.entry as e3,  e3.resource = create('Organization') as organization,  organization.id = uuid() as uuid3,  e3.fullUrl = append('urn:uuid:', uuid3),  composition.author = create('Reference') as reference,  reference.type = 'PractitionerRole',  reference.reference = append('urn:uuid:', uuid),  serviceRequest.requester = create('Reference') as reference,  reference.type = 'PractitionerRole',  reference.reference = append('urn:uuid:', uuid),  practitionerRole.practitioner = create('Reference') as reference,  reference.type = 'Practitioner',  reference.reference = append('urn:uuid:', uuid2),  practitionerRole.organization = create('Reference') as reference,  reference.type = 'Organization',  reference.reference = append('urn:uuid:', uuid3) then {
    src.item as item where (linkId.value = 'orderer.author') then OrdererAuthorItems(item, practitionerRole, practitioner, organization) "author";
    src.item as item where (linkId.value = 'orderer.dataenterer') then {
      item -&gt;  bundle.entry as e4,  e4.resource = create('PractitionerRole') as practitionerRoleDataEnterer,  practitionerRoleDataEnterer.id = uuid() as uuid4,  e4.fullUrl = append('urn:uuid:', uuid4),  composition.extension as extension,  bundle.entry as e5,  e5.resource = create('Practitioner') as practitionerDataEnterer,  practitionerDataEnterer.id = uuid() as uuid5,  e5.fullUrl = append('urn:uuid:', uuid5),  practitionerRoleDataEnterer.practitioner = create('Reference') as reference,  reference.type = 'Practitioner',  reference.reference = append('urn:uuid:', uuid5),  practitionerRoleDataEnterer.organization = create('Reference') as reference,  reference.type = 'Organization',  reference.reference = append('urn:uuid:', uuid3) then {
        item then OrdererDataEntererItems(item, practitionerRoleDataEnterer, practitionerDataEnterer, organization) "data";
        item then ChExtEprDataEnterer(item, practitionerRoleDataEnterer, extension) "extension";
      } "items";
    } "dataenterer";
  } "orderer";
}

group ResponseReceiverPatientItems(source src : BackboneElement, target patient : Patient) {
  src.item as item where ((linkId.value = 'receiverResponse.familyName') and answer.exists()) -&gt;  patient.name as name share name,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverResponse.givenName') and answer.exists()) -&gt;  patient.name as name share name,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverResponse.title') and answer.exists()) -&gt;  patient.name as name share name,  name.prefix = (item.answer.value) as prefix,  prefix.extension as ext,  ext.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',  ext.value = create('code') as value,  value.value = 'AC' "title";
  src.item as item where ((linkId.value = 'receiverResponse.phone') and answer.exists()) -&gt;  patient.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'receiverResponse.email') and answer.exists()) -&gt;  patient.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
  src.item as item where ((linkId.value = 'receiverResponse.streetAddressLine') and answer.exists()) -&gt; patient.address as address share orgAddress then {
    item.answer as answer -&gt; address.line = (answer.value) "streetAddressLine";
  } "answer";
  src.item as item where ((linkId.value = 'receiverResponse.postalCode') and answer.exists()) -&gt;  patient.address as address share orgAddress,  address.postalCode = (item.answer.value) "postalCode";
  src.item as item where ((linkId.value = 'receiverResponse.city') and answer.exists()) -&gt;  patient.address as address share orgAddress,  address.city = (item.answer.value) "city";
  src.item as item where ((linkId.value = 'receiverResponse.country') and answer.exists()) -&gt;  patient.address as address share orgAddress,  address.country = (item.answer.value) "country";
}

group ExtOrfResponseReceiverPatient(source src : BackboneElement, target patient : Patient, target ext : Extension) {
  src -&gt; ext.url = 'http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-responsereceiver' "url";
  src -&gt;  ext.value = create('Reference') as reference,  reference.type = 'Patient',  reference.reference = ('urn:uuid:' + %patient.id) "patient";
}

group ResponseReceiverOrganizationItems(source src : BackboneElement, target organization : Organization) {
  src.item as item where ((linkId.value = 'receiverResponse.organization.name') and answer.exists()) -&gt; organization.name = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverResponse.familyName') and answer.exists()) -&gt;  organization.contact as contact share contact,  contact.name as name share name,  name.family = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverResponse.givenName') and answer.exists()) -&gt;  organization.contact as contact share contact,  contact.name as name share name,  name.given = (item.answer.value);
  src.item as item where ((linkId.value = 'receiverResponse.title') and answer.exists()) -&gt;  organization.contact as contact share contact,  contact.name as name share name,  name.prefix = (item.answer.value) as prefix,  prefix.extension as ext,  ext.url = 'http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier',  ext.value = create('code') as value,  value.value = 'AC' "title";
  src.item as item where ((linkId.value = 'receiverResponse.phone') and answer.exists()) -&gt;  organization.telecom as value,  value.system = 'phone',  value.value = (item.answer.value) "phone";
  src.item as item where ((linkId.value = 'receiverResponse.email') and answer.exists()) -&gt;  organization.telecom as value,  value.system = 'email',  value.value = (item.answer.value) "email";
  src.item as item where ((linkId.value = 'receiverResponse.streetAddressLine') and answer.exists()) -&gt; organization.address as address share orgAddress then {
    item.answer as answer -&gt; address.line = (answer.value) "streetAddressLine";
  } "answer";
  src.item as item where ((linkId.value = 'receiverResponse.postalCode') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.postalCode = (item.answer.value) "postalCode";
  src.item as item where ((linkId.value = 'receiverResponse.city') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.city = (item.answer.value) "city";
  src.item as item where ((linkId.value = 'receiverResponse.country') and answer.exists()) -&gt;  organization.address as address share orgAddress,  address.country = (item.answer.value) "country";
}

group ExtOrfResponseReceiverOrganization(source src : BackboneElement, target organization : Organization, target ext : Extension) {
  src -&gt; ext.url = 'http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-responsereceiver' "url";
  src -&gt;  ext.value = create('Reference') as reference,  reference.type = 'Organization',  reference.reference = ('urn:uuid:' + %organization.id) "organization";
}

group ReceiverResponse(source grp : BackboneElement, target bundle : Bundle, target composition : Composition, target serviceRequest : ServiceRequest) {
  grp.item as item where ((linkId = 'receiverResponse') and item.where(linkId = 'receiverResponse.organization.name').answer.exists()) -&gt;  bundle.entry as e4,  e4.resource = create('Organization') as organization,  composition.extension as extension,  organization.id = uuid() as uuid4,  e4.fullUrl = append('urn:uuid:', uuid4) then {
    item then ResponseReceiverOrganizationItems(item, organization) "data";
    item then ExtOrfResponseReceiverOrganization(item, organization, extension) "extension";
  } "receiverResponseOrganization";
  grp.item as item where ((linkId = 'receiverResponse') and item.where(linkId = 'receiverResponse.organization.name').answer.exists().not()) -&gt;  bundle.entry as e4,  e4.resource = create('Patient') as patient,  composition.extension as extension,  patient.id = uuid() as uuid4,  e4.fullUrl = append('urn:uuid:', uuid4) then {
    item then ResponseReceiverPatientItems(item, patient) "data";
    item then ExtOrfResponseReceiverPatient(item, patient, extension) "extension";
  } "receiverResponsePatient";
}

group QrToBundle(source qr : QuestionnaireResponse, target patient : Patient, target questionnaireresp : QuestionnaireResponse, target servicerequest : ServiceRequest, target composition : Composition, target bundle : Bundle) {
  qr -&gt; bundle.id = uuid() "id";
  qr -&gt; bundle.type = 'document' "type";
  qr then OrfComposition(qr, composition, patient, questionnaireresp, servicerequest, bundle) "composition";
  qr then QrToGroups(qr, patient, bundle, composition, servicerequest) "qrgroups";
}

group OrfComposition(source qr : QuestionnaireResponse, target tgt : Composition, target patient : Patient, target questionnaireresp : QuestionnaireResponse, target servicerequest : ServiceRequest, target bundle : Bundle) {
  qr -&gt; tgt.status = 'final' "status";
  qr -&gt;  tgt.subject = create('Reference') as reference,  reference.type = 'Patient',  reference.reference = ('urn:uuid:' + %patient.id) "subject";
  qr -&gt;  tgt.section as tgtSection,  tgtSection.entry = create('Reference') as reference,  reference.type = 'QuestionnaireResponse',  reference.reference = ('urn:uuid:' + %questionnaireresp.id),  tgtSection.entry = create('Reference') as reference,  reference.type = 'ServiceRequest',  reference.reference = ('urn:uuid:' + %servicerequest.id) "sections";
  qr -&gt;  servicerequest.status = 'active',  servicerequest.intent = 'original-order',  servicerequest.subject = create('Reference') as reference,  reference.type = 'Patient',  reference.reference = ('urn:uuid:' + %patient.id) "servicerequest";
}

</pre>
    </div>
  </text>
  <url value="http://fhir.ch/ig/ch-orf/StructureMap/OrfQrToBundle"></url>
  <name value="OrfQrToBundle"></name>
  <description value="ORF Questionnaire Response to Bundle
2021-01-11 Oliver Egger, copyright ahdis ag, Apache License
QRF Questionnaire: http://build.fhir.org/ig/ehealthsuisse/ch-orf/Questionnaire-referral-min.html
QRF Questionnaire Response: http://build.fhir.org/ig/ehealthsuisse/ch-orf/QuestionnaireResponse-referral-min.xml.html
Bundle: http://build.fhir.org/ig/ehealthsuisse/ch-orf/StructureDefinition-ch-orf-document.html"></description>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse"></url>
    <mode value="source"></mode>
    <alias value="QuestionnaireResponse"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/Bundle"></url>
    <mode value="target"></mode>
    <alias value="Bundle"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/Patient"></url>
    <mode value="target"></mode>
    <alias value="Patient"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/Organization"></url>
    <mode value="target"></mode>
    <alias value="Organization"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/Practitioner"></url>
    <mode value="target"></mode>
    <alias value="Practitioner"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/PractitionerRole"></url>
    <mode value="target"></mode>
    <alias value="PractitionerRole"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/ServiceRequest"></url>
    <mode value="target"></mode>
    <alias value="ServiceRequest"></alias>
  </structure>
  <structure>
    <url value="http://hl7.org/fhir/StructureDefinition/BackboneElement"></url>
    <mode value="target"></mode>
    <alias value="BackboneElement"></alias>
  </structure>
  <group>
    <name value="OrfQrToBundle"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="qr"></name>
      <type value="QuestionnaireResponse"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="documentIdentifier"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="documentIdentifier"></variable>
      </target>
      <target>
        <context value="documentIdentifier"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="urn:ietf:rfc:3986"></valueString>
        </parameter>
      </target>
      <target>
        <variable value="uuidDoc"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="documentIdentifier"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuidDoc"></valueId>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="assembling time"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="timestamp"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="now()"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orfbundle"></name>
      <source>
        <context value="qr"></context>
        <variable value="qrcp"></variable>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e"></variable>
      </target>
      <target>
        <context value="e"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="composition"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Composition"></valueString>
        </parameter>
      </target>
      <target>
        <context value="composition"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e2"></variable>
      </target>
      <target>
        <context value="e2"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="patient"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Patient"></valueString>
        </parameter>
      </target>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid2"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e2"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid2"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e4"></variable>
      </target>
      <target>
        <context value="e4"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="questionnaireresp"></variable>
        <transform value="copy"></transform>
        <parameter>
          <valueId value="qrcp"></valueId>
        </parameter>
      </target>
      <target>
        <context value="questionnaireresp"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid4"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e4"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid4"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e5"></variable>
      </target>
      <target>
        <context value="e5"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="servicerequest"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="ServiceRequest"></valueString>
        </parameter>
      </target>
      <target>
        <context value="servicerequest"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid5"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e5"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid5"></valueId>
        </parameter>
      </target>
      <rule>
        <name value="orfbundle"></name>
        <source>
          <context value="qr"></context>
        </source>
        <dependent>
          <name value="QrToBundle"></name>
          <variable value="qr"></variable>
          <variable value="patient"></variable>
          <variable value="questionnaireresp"></variable>
          <variable value="servicerequest"></variable>
          <variable value="composition"></variable>
          <variable value="bundle"></variable>
        </dependent>
      </rule>
    </rule>
  </group>
  <group>
    <name value="QrToGroups"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="qr"></name>
      <type value="QuestionnaireResponse"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="patient"></name>
      <type value="Patient"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="composition"></name>
      <type value="Composition"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="serviceRequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="grporder"></name>
      <source>
        <context value="qr"></context>
        <element value="item"></element>
        <variable value="grp"></variable>
        <condition value="linkId = 'order'"></condition>
      </source>
      <dependent>
        <name value="OrderItems"></name>
        <variable value="grp"></variable>
        <variable value="bundle"></variable>
        <variable value="composition"></variable>
        <variable value="serviceRequest"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="receiverRequest"></name>
      <source>
        <context value="qr"></context>
        <element value="item"></element>
        <variable value="grp"></variable>
        <condition value="linkId = 'receiverRequest'"></condition>
      </source>
      <dependent>
        <name value="ReceiverRequestInit"></name>
        <variable value="grp"></variable>
        <variable value="bundle"></variable>
        <variable value="composition"></variable>
        <variable value="serviceRequest"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="grppatient"></name>
      <source>
        <context value="qr"></context>
        <element value="item"></element>
        <variable value="grp"></variable>
        <condition value="linkId = 'patient'"></condition>
      </source>
      <dependent>
        <name value="PatientItems"></name>
        <variable value="grp"></variable>
        <variable value="patient"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="grporderer"></name>
      <source>
        <context value="qr"></context>
        <element value="item"></element>
        <variable value="grp"></variable>
        <condition value="linkId = 'orderer'"></condition>
      </source>
      <dependent>
        <name value="OrdererAuthorInit"></name>
        <variable value="grp"></variable>
        <variable value="bundle"></variable>
        <variable value="composition"></variable>
        <variable value="serviceRequest"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="grporderer"></name>
      <source>
        <context value="qr"></context>
        <element value="item"></element>
        <variable value="grp"></variable>
        <condition value="linkId = 'receiverResponses'"></condition>
      </source>
      <dependent>
        <name value="ReceiverResponse"></name>
        <variable value="grp"></variable>
        <variable value="bundle"></variable>
        <variable value="composition"></variable>
        <variable value="serviceRequest"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="OrderItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="composition"></name>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="serviceRequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="order.precedentDocumentIdentifier"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.precedentDocumentIdentifier') and answer.exists())"></condition>
      </source>
      <target>
        <context value="composition"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-precedentdocument"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Identifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.valueString"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="order.placerOrderIdentifier"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.placerOrderIdentifier') and answer.exists())"></condition>
      </source>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="placer"></listRuleId>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <variable value="type"></variable>
      </target>
      <target>
        <context value="type"></context>
        <contextType value="variable"></contextType>
        <element value="coding"></element>
        <variable value="coding"></variable>
      </target>
      <target>
        <context value="coding"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://terminology.hl7.org/CodeSystem/v2-0203"></valueString>
        </parameter>
      </target>
      <target>
        <context value="coding"></context>
        <contextType value="variable"></contextType>
        <element value="code"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PLAC"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.valueString"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="order.placerOrderIdentifierDomain"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.placerOrderIdentifierDomain') and answer.exists())"></condition>
      </source>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="placer"></listRuleId>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.valueString"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="order.fillerOrderIdentifier"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.fillerOrderIdentifier') and answer.exists())"></condition>
      </source>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="filler"></listRuleId>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <variable value="type"></variable>
      </target>
      <target>
        <context value="type"></context>
        <contextType value="variable"></contextType>
        <element value="coding"></element>
        <variable value="coding"></variable>
      </target>
      <target>
        <context value="coding"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://terminology.hl7.org/CodeSystem/v2-0203"></valueString>
        </parameter>
      </target>
      <target>
        <context value="coding"></context>
        <contextType value="variable"></contextType>
        <element value="code"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="FILL"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.valueString"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="order.fillerOrderIdentifierDomain"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.fillerOrderIdentifierDomain') and answer.exists())"></condition>
      </source>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="filler"></listRuleId>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.valueString"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.dateTime') and answer.exists())"></condition>
      </source>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="authoredOn"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.priority') and answer.exists())"></condition>
      </source>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="priority"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value.code"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="order.notificationContactDocument"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'order.notificationContactDocument')"></condition>
      </source>
      <rule>
        <name value="order.notificationContactDocument.items"></name>
        <source>
          <context value="item"></context>
        </source>
        <target>
          <context value="bundle"></context>
          <contextType value="variable"></contextType>
          <element value="entry"></element>
          <variable value="e4"></variable>
        </target>
        <target>
          <context value="e4"></context>
          <contextType value="variable"></contextType>
          <element value="resource"></element>
          <variable value="practitionerRoleDataEnterer"></variable>
          <transform value="create"></transform>
          <parameter>
            <valueString value="PractitionerRole"></valueString>
          </parameter>
        </target>
        <target>
          <context value="practitionerRoleDataEnterer"></context>
          <contextType value="variable"></contextType>
          <element value="id"></element>
          <variable value="uuid4"></variable>
          <transform value="uuid"></transform>
        </target>
        <target>
          <context value="e4"></context>
          <contextType value="variable"></contextType>
          <element value="fullUrl"></element>
          <transform value="append"></transform>
          <parameter>
            <valueString value="urn:uuid:"></valueString>
          </parameter>
          <parameter>
            <valueId value="uuid4"></valueId>
          </parameter>
        </target>
        <target>
          <context value="composition"></context>
          <contextType value="variable"></contextType>
          <element value="extension"></element>
          <variable value="extension"></variable>
        </target>
        <target>
          <context value="bundle"></context>
          <contextType value="variable"></contextType>
          <element value="entry"></element>
          <variable value="e5"></variable>
        </target>
        <target>
          <context value="e5"></context>
          <contextType value="variable"></contextType>
          <element value="resource"></element>
          <variable value="practitionerDataEnterer"></variable>
          <transform value="create"></transform>
          <parameter>
            <valueString value="Practitioner"></valueString>
          </parameter>
        </target>
        <target>
          <context value="practitionerDataEnterer"></context>
          <contextType value="variable"></contextType>
          <element value="id"></element>
          <variable value="uuid5"></variable>
          <transform value="uuid"></transform>
        </target>
        <target>
          <context value="e5"></context>
          <contextType value="variable"></contextType>
          <element value="fullUrl"></element>
          <transform value="append"></transform>
          <parameter>
            <valueString value="urn:uuid:"></valueString>
          </parameter>
          <parameter>
            <valueId value="uuid5"></valueId>
          </parameter>
        </target>
        <target>
          <context value="practitionerRoleDataEnterer"></context>
          <contextType value="variable"></contextType>
          <element value="practitioner"></element>
          <variable value="reference"></variable>
          <transform value="create"></transform>
          <parameter>
            <valueString value="Reference"></valueString>
          </parameter>
        </target>
        <target>
          <context value="reference"></context>
          <contextType value="variable"></contextType>
          <element value="type"></element>
          <transform value="copy"></transform>
          <parameter>
            <valueString value="Practitioner"></valueString>
          </parameter>
        </target>
        <target>
          <context value="reference"></context>
          <contextType value="variable"></contextType>
          <element value="reference"></element>
          <transform value="append"></transform>
          <parameter>
            <valueString value="urn:uuid:"></valueString>
          </parameter>
          <parameter>
            <valueId value="uuid5"></valueId>
          </parameter>
        </target>
        <rule>
          <name value="data"></name>
          <source>
            <context value="item"></context>
          </source>
          <dependent>
            <name value="UrgentNotificationContactForRequestItems"></name>
            <variable value="item"></variable>
            <variable value="practitionerRoleDataEnterer"></variable>
            <variable value="practitionerDataEnterer"></variable>
          </dependent>
        </rule>
        <rule>
          <name value="extension"></name>
          <source>
            <context value="item"></context>
          </source>
          <dependent>
            <name value="ExtOrfUrgentNotificationContactForRequest"></name>
            <variable value="item"></variable>
            <variable value="practitionerRoleDataEnterer"></variable>
            <variable value="extension"></variable>
          </dependent>
        </rule>
      </rule>
    </rule>
    <rule>
      <name value="order.notificationContactDocumentResponse"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'order.notificationContactDocumentResponse')"></condition>
      </source>
      <rule>
        <name value="order.notificationContactDocumentResponse.items"></name>
        <source>
          <context value="item"></context>
        </source>
        <target>
          <context value="bundle"></context>
          <contextType value="variable"></contextType>
          <element value="entry"></element>
          <variable value="e4"></variable>
        </target>
        <target>
          <context value="e4"></context>
          <contextType value="variable"></contextType>
          <element value="resource"></element>
          <variable value="practitionerRoleDataEnterer"></variable>
          <transform value="create"></transform>
          <parameter>
            <valueString value="PractitionerRole"></valueString>
          </parameter>
        </target>
        <target>
          <context value="practitionerRoleDataEnterer"></context>
          <contextType value="variable"></contextType>
          <element value="id"></element>
          <variable value="uuid4"></variable>
          <transform value="uuid"></transform>
        </target>
        <target>
          <context value="e4"></context>
          <contextType value="variable"></contextType>
          <element value="fullUrl"></element>
          <transform value="append"></transform>
          <parameter>
            <valueString value="urn:uuid:"></valueString>
          </parameter>
          <parameter>
            <valueId value="uuid4"></valueId>
          </parameter>
        </target>
        <target>
          <context value="composition"></context>
          <contextType value="variable"></contextType>
          <element value="extension"></element>
          <variable value="extension"></variable>
        </target>
        <target>
          <context value="bundle"></context>
          <contextType value="variable"></contextType>
          <element value="entry"></element>
          <variable value="e5"></variable>
        </target>
        <target>
          <context value="e5"></context>
          <contextType value="variable"></contextType>
          <element value="resource"></element>
          <variable value="practitionerDataEnterer"></variable>
          <transform value="create"></transform>
          <parameter>
            <valueString value="Practitioner"></valueString>
          </parameter>
        </target>
        <target>
          <context value="practitionerDataEnterer"></context>
          <contextType value="variable"></contextType>
          <element value="id"></element>
          <variable value="uuid5"></variable>
          <transform value="uuid"></transform>
        </target>
        <target>
          <context value="e5"></context>
          <contextType value="variable"></contextType>
          <element value="fullUrl"></element>
          <transform value="append"></transform>
          <parameter>
            <valueString value="urn:uuid:"></valueString>
          </parameter>
          <parameter>
            <valueId value="uuid5"></valueId>
          </parameter>
        </target>
        <target>
          <context value="practitionerRoleDataEnterer"></context>
          <contextType value="variable"></contextType>
          <element value="practitioner"></element>
          <variable value="reference"></variable>
          <transform value="create"></transform>
          <parameter>
            <valueString value="Reference"></valueString>
          </parameter>
        </target>
        <target>
          <context value="reference"></context>
          <contextType value="variable"></contextType>
          <element value="type"></element>
          <transform value="copy"></transform>
          <parameter>
            <valueString value="Practitioner"></valueString>
          </parameter>
        </target>
        <target>
          <context value="reference"></context>
          <contextType value="variable"></contextType>
          <element value="reference"></element>
          <transform value="append"></transform>
          <parameter>
            <valueString value="urn:uuid:"></valueString>
          </parameter>
          <parameter>
            <valueId value="uuid5"></valueId>
          </parameter>
        </target>
        <rule>
          <name value="data"></name>
          <source>
            <context value="item"></context>
          </source>
          <dependent>
            <name value="UrgentNotificationContactForResponseItems"></name>
            <variable value="item"></variable>
            <variable value="practitionerRoleDataEnterer"></variable>
            <variable value="practitionerDataEnterer"></variable>
          </dependent>
        </rule>
        <rule>
          <name value="extension"></name>
          <source>
            <context value="item"></context>
          </source>
          <dependent>
            <name value="ExtOrfUrgentNotificationContactForResponse"></name>
            <variable value="item"></variable>
            <variable value="practitionerRoleDataEnterer"></variable>
            <variable value="extension"></variable>
          </dependent>
        </rule>
      </rule>
    </rule>
  </group>
  <group>
    <name value="UrgentNotificationContactForRequestPractitionerItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocument.practitioner.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocument.practitioner.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.title"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocument.practitioner.title') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="prefix"></element>
        <variable value="prefix"></variable>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
      <target>
        <context value="prefix"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="code"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="AC"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocument.practitioner.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocument.practitioner.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="UrgentNotificationContactForRequestItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="practitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'order.notificationContactDocument.practitioner')"></condition>
      </source>
      <dependent>
        <name value="UrgentNotificationContactForRequestPractitionerItems"></name>
        <variable value="item"></variable>
        <variable value="practitioner"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="ExtOrfUrgentNotificationContactForRequest"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="PractitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="ext"></name>
      <type value="Extension"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="url"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-urgentnoficationcontactforthisdocument"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="practitionerRole"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %practitionerRole.id"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="UrgentNotificationContactForResponsePractitionerItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocumentResponse.practitioner.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocumentResponse.practitioner.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.title"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocumentResponse.practitioner.title') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="prefix"></element>
        <variable value="prefix"></variable>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
      <target>
        <context value="prefix"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="code"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="AC"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocumentResponse.practitioner.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'order.notificationContactDocumentResponse.practitioner.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="UrgentNotificationContactForResponseItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="practitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'order.notificationContactDocumentResponse.practitioner')"></condition>
      </source>
      <dependent>
        <name value="UrgentNotificationContactForResponsePractitionerItems"></name>
        <variable value="item"></variable>
        <variable value="practitioner"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="ExtOrfUrgentNotificationContactForResponse"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="PractitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="ext"></name>
      <type value="Extension"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="url"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-urgentnoficationcontactfortheresponsetothisdocument"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="practitionerRole"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %practitionerRole.id"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ReceiverRequestPractitionerItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.practitioner.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.practitioner.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverRequest.practitioner.title"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.practitioner.title') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="prefix"></element>
        <variable value="prefix"></variable>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
      <target>
        <context value="prefix"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="code"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="AC"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverRequest.practitioner.gln"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.practitioner.gln') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="urn:oid:2.51.1.3"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverRequest.practitioner.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.practitioner.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverRequest.practitioner.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.practitioner.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ReceiverRequestOrganizationItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.organization.name') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item.answer"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.organization.streetAddressLine') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <rule>
        <name value="receiverRequest.organization.streetAddressLine"></name>
        <source>
          <context value="item"></context>
          <element value="answer"></element>
          <variable value="answer"></variable>
        </source>
        <target>
          <context value="address"></context>
          <contextType value="variable"></contextType>
          <element value="line"></element>
          <transform value="evaluate"></transform>
          <parameter>
            <valueString value="answer.value"></valueString>
          </parameter>
        </target>
      </rule>
    </rule>
    <rule>
      <name value="receiverRequest.organization.postalCode"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.organization.postalCode') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="postalCode"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverRequest.organization.city"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.organization.city') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="city"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverRequest.organization.country"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverRequest.organization.country') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="country"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ReceiverRequestItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="practitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'receiverRequest.practitioner')"></condition>
      </source>
      <dependent>
        <name value="ReceiverRequestPractitionerItems"></name>
        <variable value="item"></variable>
        <variable value="practitioner"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'receiverRequest.organization')"></condition>
      </source>
      <dependent>
        <name value="ReceiverRequestOrganizationItems"></name>
        <variable value="item"></variable>
        <variable value="organization"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="ReceiverRequestInit"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="composition"></name>
      <type value="Composition"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="serviceRequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="receiverRequest"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e"></variable>
      </target>
      <target>
        <context value="e"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="practitionerRole"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="practitionerRole"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e2"></variable>
      </target>
      <target>
        <context value="e2"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="practitioner"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Practitioner"></valueString>
        </parameter>
      </target>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid2"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e2"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid2"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e3"></variable>
      </target>
      <target>
        <context value="e3"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="organization"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Organization"></valueString>
        </parameter>
      </target>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid3"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e3"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid3"></valueId>
        </parameter>
      </target>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="performer"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid"></valueId>
        </parameter>
      </target>
      <target>
        <context value="practitionerRole"></context>
        <contextType value="variable"></contextType>
        <element value="practitioner"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Practitioner"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid2"></valueId>
        </parameter>
      </target>
      <target>
        <context value="practitionerRole"></context>
        <contextType value="variable"></contextType>
        <element value="organization"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Organization"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid3"></valueId>
        </parameter>
      </target>
      <dependent>
        <name value="ReceiverRequestItems"></name>
        <variable value="src"></variable>
        <variable value="practitionerRole"></variable>
        <variable value="practitioner"></variable>
        <variable value="organization"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="PatientItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="tgt"></name>
      <type value="Patient"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
      </source>
      <dependent>
        <name value="PatientItems"></name>
        <variable value="item"></variable>
        <variable value="tgt"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="patientName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="patientName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="patient.localPid"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.localPid') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <variable value="type"></variable>
      </target>
      <target>
        <context value="type"></context>
        <contextType value="variable"></contextType>
        <element value="coding"></element>
        <variable value="coding"></variable>
      </target>
      <target>
        <context value="coding"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://terminology.hl7.org/CodeSystem/v2-0203"></valueString>
        </parameter>
      </target>
      <target>
        <context value="coding"></context>
        <contextType value="variable"></contextType>
        <element value="code"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="MR"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.valueString"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.birthDate') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="birthDate"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.gender') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="gender"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value.code"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="patient.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="patient.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item.answer"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.streetAddressLine') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <rule>
        <name value="patient.streetAddressLine"></name>
        <source>
          <context value="item"></context>
          <element value="answer"></element>
          <variable value="answer"></variable>
        </source>
        <target>
          <context value="address"></context>
          <contextType value="variable"></contextType>
          <element value="line"></element>
          <transform value="evaluate"></transform>
          <parameter>
            <valueString value="answer.value"></valueString>
          </parameter>
        </target>
      </rule>
    </rule>
    <rule>
      <name value="patient.postalCode"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.postalCode') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="postalCode"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="patient.city"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.city') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="city"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="patient.country"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'patient.country') and answer.exists())"></condition>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="country"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="OrdererAuthorPractitionerItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.practitioner.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.practitioner.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.title"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.practitioner.title') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="prefix"></element>
        <variable value="prefix"></variable>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
      <target>
        <context value="prefix"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="code"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="AC"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.gln"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.practitioner.gln') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="identifier"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="urn:oid:2.51.1.3"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.practitioner.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.practitioner.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="OrdererAuthorOrganizationItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.organization.name') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item.answer"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.organization.streetAddressLine') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <rule>
        <name value="orderer.author.organization.streetAddressLine"></name>
        <source>
          <context value="item"></context>
          <element value="answer"></element>
          <variable value="answer"></variable>
        </source>
        <target>
          <context value="address"></context>
          <contextType value="variable"></contextType>
          <element value="line"></element>
          <transform value="evaluate"></transform>
          <parameter>
            <valueString value="answer.value"></valueString>
          </parameter>
        </target>
      </rule>
    </rule>
    <rule>
      <name value="orderer.author.organization.postalCode"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.organization.postalCode') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="postalCode"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.organization.city"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.organization.city') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="city"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.organization.country"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.author.organization.country') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="country"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="OrdererAuthorItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="practitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'orderer.author.practitioner')"></condition>
      </source>
      <dependent>
        <name value="OrdererAuthorPractitionerItems"></name>
        <variable value="item"></variable>
        <variable value="practitioner"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'orderer.author.organization')"></condition>
      </source>
      <dependent>
        <name value="OrdererAuthorOrganizationItems"></name>
        <variable value="item"></variable>
        <variable value="organization"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="OrdererDataEntererPractitionerItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.dataenterer.practitioner.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.dataenterer.practitioner.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="practitionerName"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.dataenterer.practitioner.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="orderer.author.practitioner.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'orderer.dataenterer.practitioner.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="OrdererDataEntererItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="practitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="practitioner"></name>
      <type value="Practitioner"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="(linkId.value = 'orderer.dataenterer.practitioner')"></condition>
      </source>
      <dependent>
        <name value="OrdererDataEntererPractitionerItems"></name>
        <variable value="item"></variable>
        <variable value="practitioner"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="ChExtEprDataEnterer"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="practitionerRole"></name>
      <type value="PractitionerRole"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="ext"></name>
      <type value="Extension"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="url"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-epr-dataenterer"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="practitionerRole"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="enterer"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %practitionerRole.id"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="OrdererAuthorInit"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="composition"></name>
      <type value="Composition"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="serviceRequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="orderer"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e"></variable>
      </target>
      <target>
        <context value="e"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="practitionerRole"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="practitionerRole"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e2"></variable>
      </target>
      <target>
        <context value="e2"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="practitioner"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Practitioner"></valueString>
        </parameter>
      </target>
      <target>
        <context value="practitioner"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid2"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e2"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid2"></valueId>
        </parameter>
      </target>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e3"></variable>
      </target>
      <target>
        <context value="e3"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="organization"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Organization"></valueString>
        </parameter>
      </target>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid3"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e3"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid3"></valueId>
        </parameter>
      </target>
      <target>
        <context value="composition"></context>
        <contextType value="variable"></contextType>
        <element value="author"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid"></valueId>
        </parameter>
      </target>
      <target>
        <context value="serviceRequest"></context>
        <contextType value="variable"></contextType>
        <element value="requester"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="PractitionerRole"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid"></valueId>
        </parameter>
      </target>
      <target>
        <context value="practitionerRole"></context>
        <contextType value="variable"></contextType>
        <element value="practitioner"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Practitioner"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid2"></valueId>
        </parameter>
      </target>
      <target>
        <context value="practitionerRole"></context>
        <contextType value="variable"></contextType>
        <element value="organization"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Organization"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid3"></valueId>
        </parameter>
      </target>
      <rule>
        <name value="orderer.author"></name>
        <source>
          <context value="src"></context>
          <element value="item"></element>
          <variable value="item"></variable>
          <condition value="(linkId.value = 'orderer.author')"></condition>
        </source>
        <dependent>
          <name value="OrdererAuthorItems"></name>
          <variable value="item"></variable>
          <variable value="practitionerRole"></variable>
          <variable value="practitioner"></variable>
          <variable value="organization"></variable>
        </dependent>
      </rule>
      <rule>
        <name value="orderer.dataenterer"></name>
        <source>
          <context value="src"></context>
          <element value="item"></element>
          <variable value="item"></variable>
          <condition value="(linkId.value = 'orderer.dataenterer')"></condition>
        </source>
        <rule>
          <name value="orderer.dataenterer.items"></name>
          <source>
            <context value="item"></context>
          </source>
          <target>
            <context value="bundle"></context>
            <contextType value="variable"></contextType>
            <element value="entry"></element>
            <variable value="e4"></variable>
          </target>
          <target>
            <context value="e4"></context>
            <contextType value="variable"></contextType>
            <element value="resource"></element>
            <variable value="practitionerRoleDataEnterer"></variable>
            <transform value="create"></transform>
            <parameter>
              <valueString value="PractitionerRole"></valueString>
            </parameter>
          </target>
          <target>
            <context value="practitionerRoleDataEnterer"></context>
            <contextType value="variable"></contextType>
            <element value="id"></element>
            <variable value="uuid4"></variable>
            <transform value="uuid"></transform>
          </target>
          <target>
            <context value="e4"></context>
            <contextType value="variable"></contextType>
            <element value="fullUrl"></element>
            <transform value="append"></transform>
            <parameter>
              <valueString value="urn:uuid:"></valueString>
            </parameter>
            <parameter>
              <valueId value="uuid4"></valueId>
            </parameter>
          </target>
          <target>
            <context value="composition"></context>
            <contextType value="variable"></contextType>
            <element value="extension"></element>
            <variable value="extension"></variable>
          </target>
          <target>
            <context value="bundle"></context>
            <contextType value="variable"></contextType>
            <element value="entry"></element>
            <variable value="e5"></variable>
          </target>
          <target>
            <context value="e5"></context>
            <contextType value="variable"></contextType>
            <element value="resource"></element>
            <variable value="practitionerDataEnterer"></variable>
            <transform value="create"></transform>
            <parameter>
              <valueString value="Practitioner"></valueString>
            </parameter>
          </target>
          <target>
            <context value="practitionerDataEnterer"></context>
            <contextType value="variable"></contextType>
            <element value="id"></element>
            <variable value="uuid5"></variable>
            <transform value="uuid"></transform>
          </target>
          <target>
            <context value="e5"></context>
            <contextType value="variable"></contextType>
            <element value="fullUrl"></element>
            <transform value="append"></transform>
            <parameter>
              <valueString value="urn:uuid:"></valueString>
            </parameter>
            <parameter>
              <valueId value="uuid5"></valueId>
            </parameter>
          </target>
          <target>
            <context value="practitionerRoleDataEnterer"></context>
            <contextType value="variable"></contextType>
            <element value="practitioner"></element>
            <variable value="reference"></variable>
            <transform value="create"></transform>
            <parameter>
              <valueString value="Reference"></valueString>
            </parameter>
          </target>
          <target>
            <context value="reference"></context>
            <contextType value="variable"></contextType>
            <element value="type"></element>
            <transform value="copy"></transform>
            <parameter>
              <valueString value="Practitioner"></valueString>
            </parameter>
          </target>
          <target>
            <context value="reference"></context>
            <contextType value="variable"></contextType>
            <element value="reference"></element>
            <transform value="append"></transform>
            <parameter>
              <valueString value="urn:uuid:"></valueString>
            </parameter>
            <parameter>
              <valueId value="uuid5"></valueId>
            </parameter>
          </target>
          <target>
            <context value="practitionerRoleDataEnterer"></context>
            <contextType value="variable"></contextType>
            <element value="organization"></element>
            <variable value="reference"></variable>
            <transform value="create"></transform>
            <parameter>
              <valueString value="Reference"></valueString>
            </parameter>
          </target>
          <target>
            <context value="reference"></context>
            <contextType value="variable"></contextType>
            <element value="type"></element>
            <transform value="copy"></transform>
            <parameter>
              <valueString value="Organization"></valueString>
            </parameter>
          </target>
          <target>
            <context value="reference"></context>
            <contextType value="variable"></contextType>
            <element value="reference"></element>
            <transform value="append"></transform>
            <parameter>
              <valueString value="urn:uuid:"></valueString>
            </parameter>
            <parameter>
              <valueId value="uuid3"></valueId>
            </parameter>
          </target>
          <rule>
            <name value="data"></name>
            <source>
              <context value="item"></context>
            </source>
            <dependent>
              <name value="OrdererDataEntererItems"></name>
              <variable value="item"></variable>
              <variable value="practitionerRoleDataEnterer"></variable>
              <variable value="practitionerDataEnterer"></variable>
              <variable value="organization"></variable>
            </dependent>
          </rule>
          <rule>
            <name value="extension"></name>
            <source>
              <context value="item"></context>
            </source>
            <dependent>
              <name value="ChExtEprDataEnterer"></name>
              <variable value="item"></variable>
              <variable value="practitionerRoleDataEnterer"></variable>
              <variable value="extension"></variable>
            </dependent>
          </rule>
        </rule>
      </rule>
    </rule>
  </group>
  <group>
    <name value="ResponseReceiverPatientItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="patient"></name>
      <type value="Patient"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="name"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="name"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.title"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.title') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="name"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="prefix"></element>
        <variable value="prefix"></variable>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
      <target>
        <context value="prefix"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="code"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="AC"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item.answer"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.streetAddressLine') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <rule>
        <name value="receiverResponse.streetAddressLine"></name>
        <source>
          <context value="item"></context>
          <element value="answer"></element>
          <variable value="answer"></variable>
        </source>
        <target>
          <context value="address"></context>
          <contextType value="variable"></contextType>
          <element value="line"></element>
          <transform value="evaluate"></transform>
          <parameter>
            <valueString value="answer.value"></valueString>
          </parameter>
        </target>
      </rule>
    </rule>
    <rule>
      <name value="receiverResponse.postalCode"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.postalCode') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="postalCode"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.city"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.city') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="city"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.country"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.country') and answer.exists())"></condition>
      </source>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="country"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ExtOrfResponseReceiverPatient"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="patient"></name>
      <type value="Patient"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="ext"></name>
      <type value="Extension"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="url"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-responsereceiver"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="patient"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Patient"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %patient.id"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ResponseReceiverOrganizationItems"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.organization.name') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.familyName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="contact"></element>
        <variable value="contact"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="contact"></listRuleId>
      </target>
      <target>
        <context value="contact"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="name"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="family"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.givenName') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="contact"></element>
        <variable value="contact"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="contact"></listRuleId>
      </target>
      <target>
        <context value="contact"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="name"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="given"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.title"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.title') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="contact"></element>
        <variable value="contact"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="contact"></listRuleId>
      </target>
      <target>
        <context value="contact"></context>
        <contextType value="variable"></contextType>
        <element value="name"></element>
        <variable value="name"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="name"></listRuleId>
      </target>
      <target>
        <context value="name"></context>
        <contextType value="variable"></contextType>
        <element value="prefix"></element>
        <variable value="prefix"></variable>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
      <target>
        <context value="prefix"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="ext"></variable>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"></valueString>
        </parameter>
      </target>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="value"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="code"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="AC"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.phone"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.phone') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="phone"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.email"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.email') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="telecom"></element>
        <variable value="value"></variable>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="system"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="email"></valueString>
        </parameter>
      </target>
      <target>
        <context value="value"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="item.answer"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.streetAddressLine') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <rule>
        <name value="receiverResponse.streetAddressLine"></name>
        <source>
          <context value="item"></context>
          <element value="answer"></element>
          <variable value="answer"></variable>
        </source>
        <target>
          <context value="address"></context>
          <contextType value="variable"></contextType>
          <element value="line"></element>
          <transform value="evaluate"></transform>
          <parameter>
            <valueString value="answer.value"></valueString>
          </parameter>
        </target>
      </rule>
    </rule>
    <rule>
      <name value="receiverResponse.postalCode"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.postalCode') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="postalCode"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.city"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.city') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="city"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="receiverResponse.country"></name>
      <source>
        <context value="src"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId.value = 'receiverResponse.country') and answer.exists())"></condition>
      </source>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="address"></element>
        <variable value="address"></variable>
        <listMode value="share"></listMode>
        <listRuleId value="orgAddress"></listRuleId>
      </target>
      <target>
        <context value="address"></context>
        <contextType value="variable"></contextType>
        <element value="country"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="item.answer.value"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ExtOrfResponseReceiverOrganization"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="src"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="organization"></name>
      <type value="Organization"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="ext"></name>
      <type value="Extension"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="url"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="url"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-responsereceiver"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="organization"></name>
      <source>
        <context value="src"></context>
      </source>
      <target>
        <context value="ext"></context>
        <contextType value="variable"></contextType>
        <element value="value"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Organization"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %organization.id"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
  <group>
    <name value="ReceiverResponse"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="grp"></name>
      <type value="BackboneElement"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="composition"></name>
      <type value="Composition"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="serviceRequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="receiverResponseOrganization"></name>
      <source>
        <context value="grp"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId = 'receiverResponse') and item.where(linkId = 'receiverResponse.organization.name').answer.exists())"></condition>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e4"></variable>
      </target>
      <target>
        <context value="e4"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="organization"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Organization"></valueString>
        </parameter>
      </target>
      <target>
        <context value="composition"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="extension"></variable>
      </target>
      <target>
        <context value="organization"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid4"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e4"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid4"></valueId>
        </parameter>
      </target>
      <rule>
        <name value="data"></name>
        <source>
          <context value="item"></context>
        </source>
        <dependent>
          <name value="ResponseReceiverOrganizationItems"></name>
          <variable value="item"></variable>
          <variable value="organization"></variable>
        </dependent>
      </rule>
      <rule>
        <name value="extension"></name>
        <source>
          <context value="item"></context>
        </source>
        <dependent>
          <name value="ExtOrfResponseReceiverOrganization"></name>
          <variable value="item"></variable>
          <variable value="organization"></variable>
          <variable value="extension"></variable>
        </dependent>
      </rule>
    </rule>
    <rule>
      <name value="receiverResponsePatient"></name>
      <source>
        <context value="grp"></context>
        <element value="item"></element>
        <variable value="item"></variable>
        <condition value="((linkId = 'receiverResponse') and item.where(linkId = 'receiverResponse.organization.name').answer.exists().not())"></condition>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="e4"></variable>
      </target>
      <target>
        <context value="e4"></context>
        <contextType value="variable"></contextType>
        <element value="resource"></element>
        <variable value="patient"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Patient"></valueString>
        </parameter>
      </target>
      <target>
        <context value="composition"></context>
        <contextType value="variable"></contextType>
        <element value="extension"></element>
        <variable value="extension"></variable>
      </target>
      <target>
        <context value="patient"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <variable value="uuid4"></variable>
        <transform value="uuid"></transform>
      </target>
      <target>
        <context value="e4"></context>
        <contextType value="variable"></contextType>
        <element value="fullUrl"></element>
        <transform value="append"></transform>
        <parameter>
          <valueString value="urn:uuid:"></valueString>
        </parameter>
        <parameter>
          <valueId value="uuid4"></valueId>
        </parameter>
      </target>
      <rule>
        <name value="data"></name>
        <source>
          <context value="item"></context>
        </source>
        <dependent>
          <name value="ResponseReceiverPatientItems"></name>
          <variable value="item"></variable>
          <variable value="patient"></variable>
        </dependent>
      </rule>
      <rule>
        <name value="extension"></name>
        <source>
          <context value="item"></context>
        </source>
        <dependent>
          <name value="ExtOrfResponseReceiverPatient"></name>
          <variable value="item"></variable>
          <variable value="patient"></variable>
          <variable value="extension"></variable>
        </dependent>
      </rule>
    </rule>
  </group>
  <group>
    <name value="QrToBundle"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="qr"></name>
      <type value="QuestionnaireResponse"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="patient"></name>
      <type value="Patient"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="questionnaireresp"></name>
      <type value="QuestionnaireResponse"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="servicerequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="composition"></name>
      <type value="Composition"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="id"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="id"></element>
        <transform value="uuid"></transform>
      </target>
    </rule>
    <rule>
      <name value="type"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="bundle"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="document"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="composition"></name>
      <source>
        <context value="qr"></context>
      </source>
      <dependent>
        <name value="OrfComposition"></name>
        <variable value="qr"></variable>
        <variable value="composition"></variable>
        <variable value="patient"></variable>
        <variable value="questionnaireresp"></variable>
        <variable value="servicerequest"></variable>
        <variable value="bundle"></variable>
      </dependent>
    </rule>
    <rule>
      <name value="qrgroups"></name>
      <source>
        <context value="qr"></context>
      </source>
      <dependent>
        <name value="QrToGroups"></name>
        <variable value="qr"></variable>
        <variable value="patient"></variable>
        <variable value="bundle"></variable>
        <variable value="composition"></variable>
        <variable value="servicerequest"></variable>
      </dependent>
    </rule>
  </group>
  <group>
    <name value="OrfComposition"></name>
    <typeMode value="none"></typeMode>
    <input>
      <name value="qr"></name>
      <type value="QuestionnaireResponse"></type>
      <mode value="source"></mode>
    </input>
    <input>
      <name value="tgt"></name>
      <type value="Composition"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="patient"></name>
      <type value="Patient"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="questionnaireresp"></name>
      <type value="QuestionnaireResponse"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="servicerequest"></name>
      <type value="ServiceRequest"></type>
      <mode value="target"></mode>
    </input>
    <input>
      <name value="bundle"></name>
      <type value="Bundle"></type>
      <mode value="target"></mode>
    </input>
    <rule>
      <name value="status"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="status"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="final"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="subject"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="subject"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Patient"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %patient.id"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="sections"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="tgt"></context>
        <contextType value="variable"></contextType>
        <element value="section"></element>
        <variable value="tgtSection"></variable>
      </target>
      <target>
        <context value="tgtSection"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="QuestionnaireResponse"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %questionnaireresp.id"></valueString>
        </parameter>
      </target>
      <target>
        <context value="tgtSection"></context>
        <contextType value="variable"></contextType>
        <element value="entry"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="ServiceRequest"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %servicerequest.id"></valueString>
        </parameter>
      </target>
    </rule>
    <rule>
      <name value="servicerequest"></name>
      <source>
        <context value="qr"></context>
      </source>
      <target>
        <context value="servicerequest"></context>
        <contextType value="variable"></contextType>
        <element value="status"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="active"></valueString>
        </parameter>
      </target>
      <target>
        <context value="servicerequest"></context>
        <contextType value="variable"></contextType>
        <element value="intent"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="original-order"></valueString>
        </parameter>
      </target>
      <target>
        <context value="servicerequest"></context>
        <contextType value="variable"></contextType>
        <element value="subject"></element>
        <variable value="reference"></variable>
        <transform value="create"></transform>
        <parameter>
          <valueString value="Reference"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="type"></element>
        <transform value="copy"></transform>
        <parameter>
          <valueString value="Patient"></valueString>
        </parameter>
      </target>
      <target>
        <context value="reference"></context>
        <contextType value="variable"></contextType>
        <element value="reference"></element>
        <transform value="evaluate"></transform>
        <parameter>
          <valueString value="'urn:uuid:' + %patient.id"></valueString>
        </parameter>
      </target>
    </rule>
  </group>
</StructureMap>