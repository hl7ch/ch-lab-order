{
  "resourceType": "StructureMap",
  "id": "OrfQrToBundle",
  "url": "http://fhir.ch/ig/ch-orf/StructureMap/OrfQrToBundle",
  "name": "OrfQrToBundle",
  "description": "ORF Questionnaire Response to Bundle\n2021-01-11 Oliver Egger, copyright ahdis ag, Apache License\nQRF Questionnaire: http://build.fhir.org/ig/ehealthsuisse/ch-orf/Questionnaire-referral-min.html\nQRF Questionnaire Response: http://build.fhir.org/ig/ehealthsuisse/ch-orf/QuestionnaireResponse-referral-min.xml.html\nBundle: http://build.fhir.org/ig/ehealthsuisse/ch-orf/StructureDefinition-ch-orf-document.html",
  "structure": [
    {
      "url": "http://hl7.org/fhir/StructureDefinition/QuestionnaireResponse",
      "mode": "source",
      "alias": "QuestionnaireResponse"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/Bundle",
      "mode": "target",
      "alias": "Bundle"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/Patient",
      "mode": "target",
      "alias": "Patient"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/Organization",
      "mode": "target",
      "alias": "Organization"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/Practitioner",
      "mode": "target",
      "alias": "Practitioner"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/PractitionerRole",
      "mode": "target",
      "alias": "PractitionerRole"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/ServiceRequest",
      "mode": "target",
      "alias": "ServiceRequest"
    },
    {
      "url": "http://hl7.org/fhir/StructureDefinition/BackboneElement",
      "mode": "target",
      "alias": "BackboneElement"
    }
  ],
  "group": [
    {
      "name": "OrfQrToBundle",
      "typeMode": "none",
      "input": [
        {
          "name": "qr",
          "type": "QuestionnaireResponse",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "documentIdentifier",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "identifier",
              "variable": "documentIdentifier"
            },
            {
              "context": "documentIdentifier",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "urn:ietf:rfc:3986"
                }
              ]
            },
            {
              "variable": "uuidDoc",
              "transform": "uuid"
            },
            {
              "context": "documentIdentifier",
              "contextType": "variable",
              "element": "value",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuidDoc"
                }
              ]
            }
          ]
        },
        {
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "timestamp",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "now()"
                }
              ]
            }
          ]
        },
        {
          "name": "orfbundle",
          "source": [
            {
              "context": "qr",
              "variable": "qrcp"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e"
            },
            {
              "context": "e",
              "contextType": "variable",
              "element": "resource",
              "variable": "composition",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Composition"
                }
              ]
            },
            {
              "context": "composition",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid",
              "transform": "uuid"
            },
            {
              "context": "e",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e2"
            },
            {
              "context": "e2",
              "contextType": "variable",
              "element": "resource",
              "variable": "patient",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Patient"
                }
              ]
            },
            {
              "context": "patient",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid2",
              "transform": "uuid"
            },
            {
              "context": "e2",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid2"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e4"
            },
            {
              "context": "e4",
              "contextType": "variable",
              "element": "resource",
              "variable": "questionnaireresp",
              "transform": "copy",
              "parameter": [
                {
                  "valueId": "qrcp"
                }
              ]
            },
            {
              "context": "questionnaireresp",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid4",
              "transform": "uuid"
            },
            {
              "context": "e4",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid4"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e5"
            },
            {
              "context": "e5",
              "contextType": "variable",
              "element": "resource",
              "variable": "servicerequest",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "ServiceRequest"
                }
              ]
            },
            {
              "context": "servicerequest",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid5",
              "transform": "uuid"
            },
            {
              "context": "e5",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid5"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "orfbundle",
              "source": [
                {
                  "context": "qr"
                }
              ],
              "dependent": [
                {
                  "name": "QrToBundle",
                  "variable": [
                    "qr",
                    "patient",
                    "questionnaireresp",
                    "servicerequest",
                    "composition",
                    "bundle"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "QrToGroups",
      "typeMode": "none",
      "input": [
        {
          "name": "qr",
          "type": "QuestionnaireResponse",
          "mode": "source"
        },
        {
          "name": "patient",
          "type": "Patient",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        },
        {
          "name": "composition",
          "type": "Composition",
          "mode": "target"
        },
        {
          "name": "serviceRequest",
          "type": "ServiceRequest",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "grporder",
          "source": [
            {
              "context": "qr",
              "element": "item",
              "variable": "grp",
              "condition": "linkId = 'order'"
            }
          ],
          "dependent": [
            {
              "name": "OrderItems",
              "variable": [
                "grp",
                "bundle",
                "composition",
                "serviceRequest"
              ]
            }
          ]
        },
        {
          "name": "receiverRequest",
          "source": [
            {
              "context": "qr",
              "element": "item",
              "variable": "grp",
              "condition": "linkId = 'receiverRequest'"
            }
          ],
          "dependent": [
            {
              "name": "ReceiverRequestInit",
              "variable": [
                "grp",
                "bundle",
                "composition",
                "serviceRequest"
              ]
            }
          ]
        },
        {
          "name": "grppatient",
          "source": [
            {
              "context": "qr",
              "element": "item",
              "variable": "grp",
              "condition": "linkId = 'patient'"
            }
          ],
          "dependent": [
            {
              "name": "PatientItems",
              "variable": [
                "grp",
                "patient"
              ]
            }
          ]
        },
        {
          "name": "grporderer",
          "source": [
            {
              "context": "qr",
              "element": "item",
              "variable": "grp",
              "condition": "linkId = 'orderer'"
            }
          ],
          "dependent": [
            {
              "name": "OrdererAuthorInit",
              "variable": [
                "grp",
                "bundle",
                "composition",
                "serviceRequest"
              ]
            }
          ]
        },
        {
          "name": "grporderer",
          "source": [
            {
              "context": "qr",
              "element": "item",
              "variable": "grp",
              "condition": "linkId = 'receiverResponses'"
            }
          ],
          "dependent": [
            {
              "name": "ReceiverResponse",
              "variable": [
                "grp",
                "bundle",
                "composition",
                "serviceRequest"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrderItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        },
        {
          "name": "composition",
          "mode": "target"
        },
        {
          "name": "serviceRequest",
          "type": "ServiceRequest",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "order.precedentDocumentIdentifier",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.precedentDocumentIdentifier') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "composition",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-precedentdocument"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Identifier"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.valueString"
                }
              ]
            }
          ]
        },
        {
          "name": "order.placerOrderIdentifier",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.placerOrderIdentifier') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value",
              "listMode": [
                "share"
              ],
              "listRuleId": "placer"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "type",
              "variable": "type"
            },
            {
              "context": "type",
              "contextType": "variable",
              "element": "coding",
              "variable": "coding"
            },
            {
              "context": "coding",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://terminology.hl7.org/CodeSystem/v2-0203"
                }
              ]
            },
            {
              "context": "coding",
              "contextType": "variable",
              "element": "code",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PLAC"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.valueString"
                }
              ]
            }
          ]
        },
        {
          "name": "order.placerOrderIdentifierDomain",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.placerOrderIdentifierDomain') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value",
              "listMode": [
                "share"
              ],
              "listRuleId": "placer"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.valueString"
                }
              ]
            }
          ]
        },
        {
          "name": "order.IdentifiefillerOrderIdentifier",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.IdentifiefillerOrderIdentifier') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value",
              "listMode": [
                "share"
              ],
              "listRuleId": "filler"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "type",
              "variable": "type"
            },
            {
              "context": "type",
              "contextType": "variable",
              "element": "coding",
              "variable": "coding"
            },
            {
              "context": "coding",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://terminology.hl7.org/CodeSystem/v2-0203"
                }
              ]
            },
            {
              "context": "coding",
              "contextType": "variable",
              "element": "code",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "FILL"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.valueString"
                }
              ]
            }
          ]
        },
        {
          "name": "order.IdentifiefillerOrderIdentifierDomain",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.IdentifiefillerOrderIdentifierDomain') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value",
              "listMode": [
                "share"
              ],
              "listRuleId": "filler"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.valueString"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.dateTime') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "authoredOn",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.priority') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "priority",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value.code"
                }
              ]
            }
          ]
        },
        {
          "name": "order.notificationContactDocument",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'order.notificationContactDocument')"
            }
          ],
          "rule": [
            {
              "name": "order.notificationContactDocument.items",
              "source": [
                {
                  "context": "item"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "e4"
                },
                {
                  "context": "e4",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "practitionerRoleDataEnterer",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "PractitionerRole"
                    }
                  ]
                },
                {
                  "context": "practitionerRoleDataEnterer",
                  "contextType": "variable",
                  "element": "id",
                  "variable": "uuid4",
                  "transform": "uuid"
                },
                {
                  "context": "e4",
                  "contextType": "variable",
                  "element": "fullUrl",
                  "transform": "append",
                  "parameter": [
                    {
                      "valueString": "urn:uuid:"
                    },
                    {
                      "valueId": "uuid4"
                    }
                  ]
                },
                {
                  "context": "composition",
                  "contextType": "variable",
                  "element": "extension",
                  "variable": "extension"
                },
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "e5"
                },
                {
                  "context": "e5",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "practitionerDataEnterer",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Practitioner"
                    }
                  ]
                },
                {
                  "context": "practitionerDataEnterer",
                  "contextType": "variable",
                  "element": "id",
                  "variable": "uuid5",
                  "transform": "uuid"
                },
                {
                  "context": "e5",
                  "contextType": "variable",
                  "element": "fullUrl",
                  "transform": "append",
                  "parameter": [
                    {
                      "valueString": "urn:uuid:"
                    },
                    {
                      "valueId": "uuid5"
                    }
                  ]
                },
                {
                  "context": "practitionerRoleDataEnterer",
                  "contextType": "variable",
                  "element": "practitioner",
                  "variable": "reference",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Reference"
                    }
                  ]
                },
                {
                  "context": "reference",
                  "contextType": "variable",
                  "element": "type",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner"
                    }
                  ]
                },
                {
                  "context": "reference",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "append",
                  "parameter": [
                    {
                      "valueString": "urn:uuid:"
                    },
                    {
                      "valueId": "uuid5"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "data",
                  "source": [
                    {
                      "context": "item"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "UrgentNotificationContactForRequestItems",
                      "variable": [
                        "item",
                        "practitionerRoleDataEnterer",
                        "practitionerDataEnterer"
                      ]
                    }
                  ]
                },
                {
                  "name": "extension",
                  "source": [
                    {
                      "context": "item"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtOrfUrgentNotificationContactForRequest",
                      "variable": [
                        "item",
                        "practitionerRoleDataEnterer",
                        "extension"
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "order.notificationContactDocumentResponse",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'order.notificationContactDocumentResponse')"
            }
          ],
          "rule": [
            {
              "name": "order.notificationContactDocumentResponse.items",
              "source": [
                {
                  "context": "item"
                }
              ],
              "target": [
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "e4"
                },
                {
                  "context": "e4",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "practitionerRoleDataEnterer",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "PractitionerRole"
                    }
                  ]
                },
                {
                  "context": "practitionerRoleDataEnterer",
                  "contextType": "variable",
                  "element": "id",
                  "variable": "uuid4",
                  "transform": "uuid"
                },
                {
                  "context": "e4",
                  "contextType": "variable",
                  "element": "fullUrl",
                  "transform": "append",
                  "parameter": [
                    {
                      "valueString": "urn:uuid:"
                    },
                    {
                      "valueId": "uuid4"
                    }
                  ]
                },
                {
                  "context": "composition",
                  "contextType": "variable",
                  "element": "extension",
                  "variable": "extension"
                },
                {
                  "context": "bundle",
                  "contextType": "variable",
                  "element": "entry",
                  "variable": "e5"
                },
                {
                  "context": "e5",
                  "contextType": "variable",
                  "element": "resource",
                  "variable": "practitionerDataEnterer",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Practitioner"
                    }
                  ]
                },
                {
                  "context": "practitionerDataEnterer",
                  "contextType": "variable",
                  "element": "id",
                  "variable": "uuid5",
                  "transform": "uuid"
                },
                {
                  "context": "e5",
                  "contextType": "variable",
                  "element": "fullUrl",
                  "transform": "append",
                  "parameter": [
                    {
                      "valueString": "urn:uuid:"
                    },
                    {
                      "valueId": "uuid5"
                    }
                  ]
                },
                {
                  "context": "practitionerRoleDataEnterer",
                  "contextType": "variable",
                  "element": "practitioner",
                  "variable": "reference",
                  "transform": "create",
                  "parameter": [
                    {
                      "valueString": "Reference"
                    }
                  ]
                },
                {
                  "context": "reference",
                  "contextType": "variable",
                  "element": "type",
                  "transform": "copy",
                  "parameter": [
                    {
                      "valueString": "Practitioner"
                    }
                  ]
                },
                {
                  "context": "reference",
                  "contextType": "variable",
                  "element": "reference",
                  "transform": "append",
                  "parameter": [
                    {
                      "valueString": "urn:uuid:"
                    },
                    {
                      "valueId": "uuid5"
                    }
                  ]
                }
              ],
              "rule": [
                {
                  "name": "data",
                  "source": [
                    {
                      "context": "item"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "UrgentNotificationContactForResponseItems",
                      "variable": [
                        "item",
                        "practitionerRoleDataEnterer",
                        "practitionerDataEnterer"
                      ]
                    }
                  ]
                },
                {
                  "name": "extension",
                  "source": [
                    {
                      "context": "item"
                    }
                  ],
                  "dependent": [
                    {
                      "name": "ExtOrfUrgentNotificationContactForResponse",
                      "variable": [
                        "item",
                        "practitionerRoleDataEnterer",
                        "extension"
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "UrgentNotificationContactForRequestPractitionerItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocument.practitioner.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocument.practitioner.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.title",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocument.practitioner.title') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "prefix",
              "variable": "prefix",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            },
            {
              "context": "prefix",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "code"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "AC"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocument.practitioner.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocument.practitioner.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "UrgentNotificationContactForRequestItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "practitionerRole",
          "mode": "target"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'order.notificationContactDocument.practitioner')"
            }
          ],
          "dependent": [
            {
              "name": "UrgentNotificationContactForRequestPractitionerItems",
              "variable": [
                "item",
                "practitioner"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtOrfUrgentNotificationContactForRequest",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "PractitionerRole",
          "mode": "target"
        },
        {
          "name": "ext",
          "type": "Extension",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "url",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-urgentnoficationcontactforthisdocument"
                }
              ]
            }
          ]
        },
        {
          "name": "practitionerRole",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %practitionerRole.id"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "UrgentNotificationContactForResponsePractitionerItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocumentResponse.practitioner.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocumentResponse.practitioner.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.title",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocumentResponse.practitioner.title') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "prefix",
              "variable": "prefix",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            },
            {
              "context": "prefix",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "code"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "AC"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocumentResponse.practitioner.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'order.notificationContactDocumentResponse.practitioner.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "UrgentNotificationContactForResponseItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "practitionerRole",
          "mode": "target"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'order.notificationContactDocumentResponse.practitioner')"
            }
          ],
          "dependent": [
            {
              "name": "UrgentNotificationContactForResponsePractitionerItems",
              "variable": [
                "item",
                "practitioner"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtOrfUrgentNotificationContactForResponse",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "PractitionerRole",
          "mode": "target"
        },
        {
          "name": "ext",
          "type": "Extension",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "url",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-urgentnoficationcontactfortheresponsetothisdocument"
                }
              ]
            }
          ]
        },
        {
          "name": "practitionerRole",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %practitionerRole.id"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ReceiverRequestPractitionerItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.practitioner.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.practitioner.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.practitioner.title",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.practitioner.title') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "prefix",
              "variable": "prefix",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            },
            {
              "context": "prefix",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "code"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "AC"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.practitioner.gln",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.practitioner.gln') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "urn:oid:2.51.1.3"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.practitioner.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.practitioner.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.practitioner.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.practitioner.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ReceiverRequestOrganizationItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.organization.name') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "name",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item.answer",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.organization.streetAddressLine') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            }
          ],
          "rule": [
            {
              "name": "receiverRequest.organization.streetAddressLine",
              "source": [
                {
                  "context": "item",
                  "element": "answer",
                  "variable": "answer"
                }
              ],
              "target": [
                {
                  "context": "address",
                  "contextType": "variable",
                  "element": "line",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueString": "answer.value"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.organization.postalCode",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.organization.postalCode') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "postalCode",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.organization.city",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.organization.city') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "city",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverRequest.organization.country",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverRequest.organization.country') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "country",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ReceiverRequestItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "practitionerRole",
          "mode": "target"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'receiverRequest.practitioner')"
            }
          ],
          "dependent": [
            {
              "name": "ReceiverRequestPractitionerItems",
              "variable": [
                "item",
                "practitioner"
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'receiverRequest.organization')"
            }
          ],
          "dependent": [
            {
              "name": "ReceiverRequestOrganizationItems",
              "variable": [
                "item",
                "organization"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ReceiverRequestInit",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        },
        {
          "name": "composition",
          "type": "Composition",
          "mode": "target"
        },
        {
          "name": "serviceRequest",
          "type": "ServiceRequest",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "receiverRequest",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e"
            },
            {
              "context": "e",
              "contextType": "variable",
              "element": "resource",
              "variable": "practitionerRole",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "practitionerRole",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid",
              "transform": "uuid"
            },
            {
              "context": "e",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e2"
            },
            {
              "context": "e2",
              "contextType": "variable",
              "element": "resource",
              "variable": "practitioner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Practitioner"
                }
              ]
            },
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid2",
              "transform": "uuid"
            },
            {
              "context": "e2",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid2"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e3"
            },
            {
              "context": "e3",
              "contextType": "variable",
              "element": "resource",
              "variable": "organization",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Organization"
                }
              ]
            },
            {
              "context": "organization",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid3",
              "transform": "uuid"
            },
            {
              "context": "e3",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid3"
                }
              ]
            },
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "performer",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid"
                }
              ]
            },
            {
              "context": "practitionerRole",
              "contextType": "variable",
              "element": "practitioner",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Practitioner"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid2"
                }
              ]
            },
            {
              "context": "practitionerRole",
              "contextType": "variable",
              "element": "organization",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Organization"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid3"
                }
              ]
            }
          ],
          "dependent": [
            {
              "name": "ReceiverRequestItems",
              "variable": [
                "src",
                "practitionerRole",
                "practitioner",
                "organization"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "PatientItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "tgt",
          "type": "Patient",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item"
            }
          ],
          "dependent": [
            {
              "name": "PatientItems",
              "variable": [
                "item",
                "tgt"
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "patientName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "patientName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "patient.localPid",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.localPid') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "type",
              "variable": "type"
            },
            {
              "context": "type",
              "contextType": "variable",
              "element": "coding",
              "variable": "coding"
            },
            {
              "context": "coding",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://terminology.hl7.org/CodeSystem/v2-0203"
                }
              ]
            },
            {
              "context": "coding",
              "contextType": "variable",
              "element": "code",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "MR"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.valueString"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.birthDate') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "birthDate",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.gender') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "gender",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value.code"
                }
              ]
            }
          ]
        },
        {
          "name": "patient.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "patient.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item.answer",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.streetAddressLine') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            }
          ],
          "rule": [
            {
              "name": "patient.streetAddressLine",
              "source": [
                {
                  "context": "item",
                  "element": "answer",
                  "variable": "answer"
                }
              ],
              "target": [
                {
                  "context": "address",
                  "contextType": "variable",
                  "element": "line",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueString": "answer.value"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "patient.postalCode",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.postalCode') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "postalCode",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "patient.city",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.city') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "city",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "patient.country",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'patient.country') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "country",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrdererAuthorPractitionerItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.practitioner.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.practitioner.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.title",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.practitioner.title') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "prefix",
              "variable": "prefix",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            },
            {
              "context": "prefix",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "code"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "AC"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.gln",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.practitioner.gln') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "identifier",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "urn:oid:2.51.1.3"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.practitioner.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.practitioner.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrdererAuthorOrganizationItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.organization.name') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "name",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item.answer",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.organization.streetAddressLine') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            }
          ],
          "rule": [
            {
              "name": "orderer.author.organization.streetAddressLine",
              "source": [
                {
                  "context": "item",
                  "element": "answer",
                  "variable": "answer"
                }
              ],
              "target": [
                {
                  "context": "address",
                  "contextType": "variable",
                  "element": "line",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueString": "answer.value"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.organization.postalCode",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.organization.postalCode') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "postalCode",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.organization.city",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.organization.city') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "city",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.organization.country",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.author.organization.country') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "country",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrdererAuthorItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "practitionerRole",
          "mode": "target"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'orderer.author.practitioner')"
            }
          ],
          "dependent": [
            {
              "name": "OrdererAuthorPractitionerItems",
              "variable": [
                "item",
                "practitioner"
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'orderer.author.organization')"
            }
          ],
          "dependent": [
            {
              "name": "OrdererAuthorOrganizationItems",
              "variable": [
                "item",
                "organization"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrdererDataEntererPractitionerItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.dataenterer.practitioner.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.dataenterer.practitioner.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "practitionerName"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.dataenterer.practitioner.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "orderer.author.practitioner.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'orderer.dataenterer.practitioner.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrdererDataEntererItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "practitionerRole",
          "mode": "target"
        },
        {
          "name": "practitioner",
          "type": "Practitioner",
          "mode": "target"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "(linkId.value = 'orderer.dataenterer.practitioner')"
            }
          ],
          "dependent": [
            {
              "name": "OrdererDataEntererPractitionerItems",
              "variable": [
                "item",
                "practitioner"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ChExtEprDataEnterer",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "practitionerRole",
          "type": "PractitionerRole",
          "mode": "target"
        },
        {
          "name": "ext",
          "type": "Extension",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "url",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://fhir.ch/ig/ch-core/StructureDefinition/ch-ext-epr-dataenterer"
                }
              ]
            }
          ]
        },
        {
          "name": "practitionerRole",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "enterer"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %practitionerRole.id"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrdererAuthorInit",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        },
        {
          "name": "composition",
          "type": "Composition",
          "mode": "target"
        },
        {
          "name": "serviceRequest",
          "type": "ServiceRequest",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "orderer",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e"
            },
            {
              "context": "e",
              "contextType": "variable",
              "element": "resource",
              "variable": "practitionerRole",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "practitionerRole",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid",
              "transform": "uuid"
            },
            {
              "context": "e",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e2"
            },
            {
              "context": "e2",
              "contextType": "variable",
              "element": "resource",
              "variable": "practitioner",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Practitioner"
                }
              ]
            },
            {
              "context": "practitioner",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid2",
              "transform": "uuid"
            },
            {
              "context": "e2",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid2"
                }
              ]
            },
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e3"
            },
            {
              "context": "e3",
              "contextType": "variable",
              "element": "resource",
              "variable": "organization",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Organization"
                }
              ]
            },
            {
              "context": "organization",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid3",
              "transform": "uuid"
            },
            {
              "context": "e3",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid3"
                }
              ]
            },
            {
              "context": "composition",
              "contextType": "variable",
              "element": "author",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid"
                }
              ]
            },
            {
              "context": "serviceRequest",
              "contextType": "variable",
              "element": "requester",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "PractitionerRole"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid"
                }
              ]
            },
            {
              "context": "practitionerRole",
              "contextType": "variable",
              "element": "practitioner",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Practitioner"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid2"
                }
              ]
            },
            {
              "context": "practitionerRole",
              "contextType": "variable",
              "element": "organization",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Organization"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid3"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "orderer.author",
              "source": [
                {
                  "context": "src",
                  "element": "item",
                  "variable": "item",
                  "condition": "(linkId.value = 'orderer.author')"
                }
              ],
              "dependent": [
                {
                  "name": "OrdererAuthorItems",
                  "variable": [
                    "item",
                    "practitionerRole",
                    "practitioner",
                    "organization"
                  ]
                }
              ]
            },
            {
              "name": "orderer.dataenterer",
              "source": [
                {
                  "context": "src",
                  "element": "item",
                  "variable": "item",
                  "condition": "(linkId.value = 'orderer.dataenterer')"
                }
              ],
              "rule": [
                {
                  "name": "orderer.dataenterer.items",
                  "source": [
                    {
                      "context": "item"
                    }
                  ],
                  "target": [
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "e4"
                    },
                    {
                      "context": "e4",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "practitionerRoleDataEnterer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "PractitionerRole"
                        }
                      ]
                    },
                    {
                      "context": "practitionerRoleDataEnterer",
                      "contextType": "variable",
                      "element": "id",
                      "variable": "uuid4",
                      "transform": "uuid"
                    },
                    {
                      "context": "e4",
                      "contextType": "variable",
                      "element": "fullUrl",
                      "transform": "append",
                      "parameter": [
                        {
                          "valueString": "urn:uuid:"
                        },
                        {
                          "valueId": "uuid4"
                        }
                      ]
                    },
                    {
                      "context": "composition",
                      "contextType": "variable",
                      "element": "extension",
                      "variable": "extension"
                    },
                    {
                      "context": "bundle",
                      "contextType": "variable",
                      "element": "entry",
                      "variable": "e5"
                    },
                    {
                      "context": "e5",
                      "contextType": "variable",
                      "element": "resource",
                      "variable": "practitionerDataEnterer",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Practitioner"
                        }
                      ]
                    },
                    {
                      "context": "practitionerDataEnterer",
                      "contextType": "variable",
                      "element": "id",
                      "variable": "uuid5",
                      "transform": "uuid"
                    },
                    {
                      "context": "e5",
                      "contextType": "variable",
                      "element": "fullUrl",
                      "transform": "append",
                      "parameter": [
                        {
                          "valueString": "urn:uuid:"
                        },
                        {
                          "valueId": "uuid5"
                        }
                      ]
                    },
                    {
                      "context": "practitionerRoleDataEnterer",
                      "contextType": "variable",
                      "element": "practitioner",
                      "variable": "reference",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    },
                    {
                      "context": "reference",
                      "contextType": "variable",
                      "element": "type",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Practitioner"
                        }
                      ]
                    },
                    {
                      "context": "reference",
                      "contextType": "variable",
                      "element": "reference",
                      "transform": "append",
                      "parameter": [
                        {
                          "valueString": "urn:uuid:"
                        },
                        {
                          "valueId": "uuid5"
                        }
                      ]
                    },
                    {
                      "context": "practitionerRoleDataEnterer",
                      "contextType": "variable",
                      "element": "organization",
                      "variable": "reference",
                      "transform": "create",
                      "parameter": [
                        {
                          "valueString": "Reference"
                        }
                      ]
                    },
                    {
                      "context": "reference",
                      "contextType": "variable",
                      "element": "type",
                      "transform": "copy",
                      "parameter": [
                        {
                          "valueString": "Organization"
                        }
                      ]
                    },
                    {
                      "context": "reference",
                      "contextType": "variable",
                      "element": "reference",
                      "transform": "append",
                      "parameter": [
                        {
                          "valueString": "urn:uuid:"
                        },
                        {
                          "valueId": "uuid3"
                        }
                      ]
                    }
                  ],
                  "rule": [
                    {
                      "name": "data",
                      "source": [
                        {
                          "context": "item"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "OrdererDataEntererItems",
                          "variable": [
                            "item",
                            "practitionerRoleDataEnterer",
                            "practitionerDataEnterer",
                            "organization"
                          ]
                        }
                      ]
                    },
                    {
                      "name": "extension",
                      "source": [
                        {
                          "context": "item"
                        }
                      ],
                      "dependent": [
                        {
                          "name": "ChExtEprDataEnterer",
                          "variable": [
                            "item",
                            "practitionerRoleDataEnterer",
                            "extension"
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ResponseReceiverPatientItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "patient",
          "type": "Patient",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "name"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "name"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.title",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.title') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "name"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "prefix",
              "variable": "prefix",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            },
            {
              "context": "prefix",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "code"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "AC"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item.answer",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.streetAddressLine') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            }
          ],
          "rule": [
            {
              "name": "receiverResponse.streetAddressLine",
              "source": [
                {
                  "context": "item",
                  "element": "answer",
                  "variable": "answer"
                }
              ],
              "target": [
                {
                  "context": "address",
                  "contextType": "variable",
                  "element": "line",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueString": "answer.value"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.postalCode",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.postalCode') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "postalCode",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.city",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.city') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "city",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.country",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.country') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "patient",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "country",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtOrfResponseReceiverPatient",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "patient",
          "type": "Patient",
          "mode": "target"
        },
        {
          "name": "ext",
          "type": "Extension",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "url",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-responsereceiver"
                }
              ]
            }
          ]
        },
        {
          "name": "patient",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Patient"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %patient.id"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ResponseReceiverOrganizationItems",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.organization.name') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "name",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.familyName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "contact",
              "variable": "contact",
              "listMode": [
                "share"
              ],
              "listRuleId": "contact"
            },
            {
              "context": "contact",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "name"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "family",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.givenName') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "contact",
              "variable": "contact",
              "listMode": [
                "share"
              ],
              "listRuleId": "contact"
            },
            {
              "context": "contact",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "name"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "given",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.title",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.title') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "contact",
              "variable": "contact",
              "listMode": [
                "share"
              ],
              "listRuleId": "contact"
            },
            {
              "context": "contact",
              "contextType": "variable",
              "element": "name",
              "variable": "name",
              "listMode": [
                "share"
              ],
              "listRuleId": "name"
            },
            {
              "context": "name",
              "contextType": "variable",
              "element": "prefix",
              "variable": "prefix",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            },
            {
              "context": "prefix",
              "contextType": "variable",
              "element": "extension",
              "variable": "ext"
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://hl7.org/fhir/StructureDefinition/iso21090-EN-qualifier"
                }
              ]
            },
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "value",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "code"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "AC"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.phone",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.phone') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "phone"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.email",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.email') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "telecom",
              "variable": "value"
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "system",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "email"
                }
              ]
            },
            {
              "context": "value",
              "contextType": "variable",
              "element": "value",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "item.answer",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.streetAddressLine') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            }
          ],
          "rule": [
            {
              "name": "receiverResponse.streetAddressLine",
              "source": [
                {
                  "context": "item",
                  "element": "answer",
                  "variable": "answer"
                }
              ],
              "target": [
                {
                  "context": "address",
                  "contextType": "variable",
                  "element": "line",
                  "transform": "evaluate",
                  "parameter": [
                    {
                      "valueString": "answer.value"
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.postalCode",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.postalCode') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "postalCode",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.city",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.city') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "city",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponse.country",
          "source": [
            {
              "context": "src",
              "element": "item",
              "variable": "item",
              "condition": "((linkId.value = 'receiverResponse.country') and answer.exists())"
            }
          ],
          "target": [
            {
              "context": "organization",
              "contextType": "variable",
              "element": "address",
              "variable": "address",
              "listMode": [
                "share"
              ],
              "listRuleId": "orgAddress"
            },
            {
              "context": "address",
              "contextType": "variable",
              "element": "country",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "item.answer.value"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ExtOrfResponseReceiverOrganization",
      "typeMode": "none",
      "input": [
        {
          "name": "src",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "organization",
          "type": "Organization",
          "mode": "target"
        },
        {
          "name": "ext",
          "type": "Extension",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "url",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "url",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "http://fhir.ch/ig/ch-orf/StructureDefinition/ch-orf-responsereceiver"
                }
              ]
            }
          ]
        },
        {
          "name": "organization",
          "source": [
            {
              "context": "src"
            }
          ],
          "target": [
            {
              "context": "ext",
              "contextType": "variable",
              "element": "value",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Organization"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %organization.id"
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "ReceiverResponse",
      "typeMode": "none",
      "input": [
        {
          "name": "grp",
          "type": "BackboneElement",
          "mode": "source"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        },
        {
          "name": "composition",
          "type": "Composition",
          "mode": "target"
        },
        {
          "name": "serviceRequest",
          "type": "ServiceRequest",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "receiverResponseOrganization",
          "source": [
            {
              "context": "grp",
              "element": "item",
              "variable": "item",
              "condition": "((linkId = 'receiverResponse') and item.where(linkId = 'receiverResponse.organization.name').answer.exists())"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e4"
            },
            {
              "context": "e4",
              "contextType": "variable",
              "element": "resource",
              "variable": "organization",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Organization"
                }
              ]
            },
            {
              "context": "composition",
              "contextType": "variable",
              "element": "extension",
              "variable": "extension"
            },
            {
              "context": "organization",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid4",
              "transform": "uuid"
            },
            {
              "context": "e4",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid4"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "data",
              "source": [
                {
                  "context": "item"
                }
              ],
              "dependent": [
                {
                  "name": "ResponseReceiverOrganizationItems",
                  "variable": [
                    "item",
                    "organization"
                  ]
                }
              ]
            },
            {
              "name": "extension",
              "source": [
                {
                  "context": "item"
                }
              ],
              "dependent": [
                {
                  "name": "ExtOrfResponseReceiverOrganization",
                  "variable": [
                    "item",
                    "organization",
                    "extension"
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "receiverResponsePatient",
          "source": [
            {
              "context": "grp",
              "element": "item",
              "variable": "item",
              "condition": "((linkId = 'receiverResponse') and item.where(linkId = 'receiverResponse.organization.name').answer.exists().not())"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "entry",
              "variable": "e4"
            },
            {
              "context": "e4",
              "contextType": "variable",
              "element": "resource",
              "variable": "patient",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Patient"
                }
              ]
            },
            {
              "context": "composition",
              "contextType": "variable",
              "element": "extension",
              "variable": "extension"
            },
            {
              "context": "patient",
              "contextType": "variable",
              "element": "id",
              "variable": "uuid4",
              "transform": "uuid"
            },
            {
              "context": "e4",
              "contextType": "variable",
              "element": "fullUrl",
              "transform": "append",
              "parameter": [
                {
                  "valueString": "urn:uuid:"
                },
                {
                  "valueId": "uuid4"
                }
              ]
            }
          ],
          "rule": [
            {
              "name": "data",
              "source": [
                {
                  "context": "item"
                }
              ],
              "dependent": [
                {
                  "name": "ResponseReceiverPatientItems",
                  "variable": [
                    "item",
                    "patient"
                  ]
                }
              ]
            },
            {
              "name": "extension",
              "source": [
                {
                  "context": "item"
                }
              ],
              "dependent": [
                {
                  "name": "ExtOrfResponseReceiverPatient",
                  "variable": [
                    "item",
                    "patient",
                    "extension"
                  ]
                }
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "QrToBundle",
      "typeMode": "none",
      "input": [
        {
          "name": "qr",
          "type": "QuestionnaireResponse",
          "mode": "source"
        },
        {
          "name": "patient",
          "type": "Patient",
          "mode": "target"
        },
        {
          "name": "questionnaireresp",
          "type": "QuestionnaireResponse",
          "mode": "target"
        },
        {
          "name": "servicerequest",
          "type": "ServiceRequest",
          "mode": "target"
        },
        {
          "name": "composition",
          "type": "Composition",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "id",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "id",
              "transform": "uuid"
            }
          ]
        },
        {
          "name": "type",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "bundle",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "document"
                }
              ]
            }
          ]
        },
        {
          "name": "composition",
          "source": [
            {
              "context": "qr"
            }
          ],
          "dependent": [
            {
              "name": "OrfComposition",
              "variable": [
                "qr",
                "composition",
                "patient",
                "questionnaireresp",
                "servicerequest",
                "bundle"
              ]
            }
          ]
        },
        {
          "name": "qrgroups",
          "source": [
            {
              "context": "qr"
            }
          ],
          "dependent": [
            {
              "name": "QrToGroups",
              "variable": [
                "qr",
                "patient",
                "bundle",
                "composition",
                "servicerequest"
              ]
            }
          ]
        }
      ]
    },
    {
      "name": "OrfComposition",
      "typeMode": "none",
      "input": [
        {
          "name": "qr",
          "type": "QuestionnaireResponse",
          "mode": "source"
        },
        {
          "name": "tgt",
          "type": "Composition",
          "mode": "target"
        },
        {
          "name": "patient",
          "type": "Patient",
          "mode": "target"
        },
        {
          "name": "questionnaireresp",
          "type": "QuestionnaireResponse",
          "mode": "target"
        },
        {
          "name": "servicerequest",
          "type": "ServiceRequest",
          "mode": "target"
        },
        {
          "name": "bundle",
          "type": "Bundle",
          "mode": "target"
        }
      ],
      "rule": [
        {
          "name": "status",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "final"
                }
              ]
            }
          ]
        },
        {
          "name": "subject",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "subject",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Patient"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %patient.id"
                }
              ]
            }
          ]
        },
        {
          "name": "sections",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "tgt",
              "contextType": "variable",
              "element": "section",
              "variable": "tgtSection"
            },
            {
              "context": "tgtSection",
              "contextType": "variable",
              "element": "entry",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "QuestionnaireResponse"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %questionnaireresp.id"
                }
              ]
            },
            {
              "context": "tgtSection",
              "contextType": "variable",
              "element": "entry",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "ServiceRequest"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %servicerequest.id"
                }
              ]
            }
          ]
        },
        {
          "name": "servicerequest",
          "source": [
            {
              "context": "qr"
            }
          ],
          "target": [
            {
              "context": "servicerequest",
              "contextType": "variable",
              "element": "status",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "active"
                }
              ]
            },
            {
              "context": "servicerequest",
              "contextType": "variable",
              "element": "intent",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "original-order"
                }
              ]
            },
            {
              "context": "servicerequest",
              "contextType": "variable",
              "element": "subject",
              "variable": "reference",
              "transform": "create",
              "parameter": [
                {
                  "valueString": "Reference"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "type",
              "transform": "copy",
              "parameter": [
                {
                  "valueString": "Patient"
                }
              ]
            },
            {
              "context": "reference",
              "contextType": "variable",
              "element": "reference",
              "transform": "evaluate",
              "parameter": [
                {
                  "valueString": "'urn:uuid:' + %patient.id"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
